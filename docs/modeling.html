---

title: modeling

keywords: fastai
sidebar: home_sidebar

summary: "This module contains custom models, loss functions, and a default layer group splitter for use in applying discriminiative learning rates to your huggingface models trained via fastai"
description: "This module contains custom models, loss functions, and a default layer group splitter for use in applying discriminiative learning rates to your huggingface models trained via fastai"
---
<!--

#################################################
### THIS FILE WAS AUTOGENERATED! DO NOT EDIT! ###
#################################################
# file to edit: nbs/02_modeling.ipynb
# command to build the docs after a change: nbdev_build_docs

-->

<div class="container" id="notebook-container">
        
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1">#cuda</span>
<span class="n">torch</span><span class="o">.</span><span class="n">cuda</span><span class="o">.</span><span class="n">set_device</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Using GPU #</span><span class="si">{</span><span class="n">torch</span><span class="o">.</span><span class="n">cuda</span><span class="o">.</span><span class="n">current_device</span><span class="p">()</span><span class="si">}</span><span class="s1">: </span><span class="si">{</span><span class="n">torch</span><span class="o">.</span><span class="n">cuda</span><span class="o">.</span><span class="n">get_device_name</span><span class="p">()</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>Using GPU #1: GeForce GTX 1080 Ti
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Base-splitter-and-model-wrapper">Base splitter and model wrapper<a class="anchor-link" href="#Base-splitter-and-model-wrapper"> </a></h2>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="hf_splitter" class="doc_header"><code>hf_splitter</code><a href="https://github.com/ohmeow/blurr/tree/master/blurr/modeling.py#L17" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>hf_splitter</code>(<strong><code>m</code></strong>)</p>
</blockquote>
<p>Splits the huggingface model based on various model architecture conventions</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h2 id="HF_BaseModelCallback" class="doc_header"><code>class</code> <code>HF_BaseModelCallback</code><a href="https://github.com/ohmeow/blurr/tree/master/blurr/modeling.py#L29" class="source_link" style="float:right">[source]</a></h2><blockquote><p><code>HF_BaseModelCallback</code>() :: <code>Callback</code></p>
</blockquote>
<p>Basic class handling tweaks of the training loop by changing a <code>Learner</code> in various events</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h2 id="HF_BaseModelWrapper" class="doc_header"><code>class</code> <code>HF_BaseModelWrapper</code><a href="https://github.com/ohmeow/blurr/tree/master/blurr/modeling.py#L52" class="source_link" style="float:right">[source]</a></h2><blockquote><p><code>HF_BaseModelWrapper</code>(<strong><code>hf_model</code></strong>) :: <code>Module</code></p>
</blockquote>
<p>Same as <code>nn.Module</code>, but no need for subclasses to call <code>super().__init__</code></p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Note that <code>HF_baseModelWrapper</code> includes some nifty code for just passing in the things your model needs, as not all transformer architectures require/use the same information.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Examples">Examples<a class="anchor-link" href="#Examples"> </a></h2>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Sequence-classification">Sequence classification<a class="anchor-link" href="#Sequence-classification"> </a></h3>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">path</span> <span class="o">=</span> <span class="n">untar_data</span><span class="p">(</span><span class="n">URLs</span><span class="o">.</span><span class="n">IMDB_SAMPLE</span><span class="p">)</span>

<span class="n">model_path</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="s1">&#39;models&#39;</span><span class="p">)</span>
<span class="n">imdb_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">path</span><span class="o">/</span><span class="s1">&#39;texts.csv&#39;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">imdb_df</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>label</th>
      <th>text</th>
      <th>is_valid</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>negative</td>
      <td>Un-bleeping-believable! Meg Ryan doesn't even look her usual pert lovable self in this, which normally makes me forgive her shallow ticky acting schtick. Hard to believe she was the producer on this dog. Plus Kevin Kline: what kind of suicide trip has his career been on? Whoosh... Banzai!!! Finally this was directed by the guy who did Big Chill? Must be a replay of Jonestown - hollywood style. Wooofff!</td>
      <td>False</td>
    </tr>
    <tr>
      <th>1</th>
      <td>positive</td>
      <td>This is a extremely well-made film. The acting, script and camera-work are all first-rate. The music is good, too, though it is mostly early in the film, when things are still relatively cheery. There are no really superstars in the cast, though several faces will be familiar. The entire cast does an excellent job with the script.&lt;br /&gt;&lt;br /&gt;But it is hard to watch, because there is no good end to a situation like the one presented. It is now fashionable to blame the British for setting Hindus and Muslims against each other, and then cruelly separating them into two countries. There is som...</td>
      <td>False</td>
    </tr>
    <tr>
      <th>2</th>
      <td>negative</td>
      <td>Every once in a long while a movie will come along that will be so awful that I feel compelled to warn people. If I labor all my days and I can save but one soul from watching this movie, how great will be my joy.&lt;br /&gt;&lt;br /&gt;Where to begin my discussion of pain. For starters, there was a musical montage every five minutes. There was no character development. Every character was a stereotype. We had swearing guy, fat guy who eats donuts, goofy foreign guy, etc. The script felt as if it were being written as the movie was being shot. The production value was so incredibly low that it felt li...</td>
      <td>False</td>
    </tr>
    <tr>
      <th>3</th>
      <td>positive</td>
      <td>Name just says it all. I watched this movie with my dad when it came out and having served in Korea he had great admiration for the man. The disappointing thing about this film is that it only concentrate on a short period of the man's life - interestingly enough the man's entire life would have made such an epic bio-pic that it is staggering to imagine the cost for production.&lt;br /&gt;&lt;br /&gt;Some posters elude to the flawed characteristics about the man, which are cheap shots. The theme of the movie "Duty, Honor, Country" are not just mere words blathered from the lips of a high-brassed offic...</td>
      <td>False</td>
    </tr>
    <tr>
      <th>4</th>
      <td>negative</td>
      <td>This movie succeeds at being one of the most unique movies you've seen. However this comes from the fact that you can't make heads or tails of this mess. It almost seems as a series of challenges set up to determine whether or not you are willing to walk out of the movie and give up the money you just paid. If you don't want to feel slighted you'll sit through this horrible film and develop a real sense of pity for the actors involved, they've all seen better days, but then you realize they actually got paid quite a bit of money to do this and you'll lose pity for them just like you've alr...</td>
      <td>False</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">task</span> <span class="o">=</span> <span class="n">HF_TASKS_AUTO</span><span class="o">.</span><span class="n">ForSequenceClassification</span>

<span class="n">pretrained_model_name</span> <span class="o">=</span> <span class="s2">&quot;roberta-base&quot;</span> <span class="c1"># &quot;distilbert-base-uncased&quot; &quot;bert-base-uncased&quot;</span>
<span class="n">config</span> <span class="o">=</span> <span class="n">AutoConfig</span><span class="o">.</span><span class="n">from_pretrained</span><span class="p">(</span><span class="n">pretrained_model_name</span><span class="p">)</span>

<span class="n">hf_arch</span><span class="p">,</span> <span class="n">hf_tokenizer</span><span class="p">,</span> <span class="n">hf_config</span><span class="p">,</span> <span class="n">hf_model</span> <span class="o">=</span> <span class="n">BLURR_MODEL_HELPER</span><span class="o">.</span><span class="n">get_auto_hf_objects</span><span class="p">(</span><span class="n">pretrained_model_name</span><span class="p">,</span> 
                                                                                    <span class="n">task</span><span class="o">=</span><span class="n">task</span><span class="p">,</span> 
                                                                                    <span class="n">config</span><span class="o">=</span><span class="n">config</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># single input</span>
<span class="n">blocks</span> <span class="o">=</span> <span class="p">(</span>
    <span class="n">HF_TextBlock</span><span class="o">.</span><span class="n">from_df</span><span class="p">(</span><span class="n">text_cols_lists</span><span class="o">=</span><span class="p">[[</span><span class="s1">&#39;text&#39;</span><span class="p">]],</span> <span class="n">hf_arch</span><span class="o">=</span><span class="n">hf_arch</span><span class="p">,</span> <span class="n">hf_tokenizer</span><span class="o">=</span><span class="n">hf_tokenizer</span><span class="p">),</span>
    <span class="n">CategoryBlock</span>
<span class="p">)</span>

<span class="c1"># can&#39;t export lambda functions, so made the getter a standard method</span>
<span class="k">def</span> <span class="nf">get_x</span><span class="p">(</span><span class="n">x</span><span class="p">):</span> 
    <span class="k">return</span> <span class="n">x</span><span class="o">.</span><span class="n">text0</span>

<span class="n">dblock</span> <span class="o">=</span> <span class="n">DataBlock</span><span class="p">(</span><span class="n">blocks</span><span class="o">=</span><span class="n">blocks</span><span class="p">,</span> 
                   <span class="n">get_x</span><span class="o">=</span><span class="n">get_x</span><span class="p">,</span>
                   <span class="n">get_y</span><span class="o">=</span><span class="n">ColReader</span><span class="p">(</span><span class="s1">&#39;label&#39;</span><span class="p">),</span> 
                   <span class="n">splitter</span><span class="o">=</span><span class="n">ColSplitter</span><span class="p">(</span><span class="n">col</span><span class="o">=</span><span class="s1">&#39;is_valid&#39;</span><span class="p">))</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">dls</span> <span class="o">=</span> <span class="n">dblock</span><span class="o">.</span><span class="n">dataloaders</span><span class="p">(</span><span class="n">imdb_df</span><span class="p">,</span> <span class="n">bs</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea ">

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">dls</span><span class="o">.</span><span class="n">show_batch</span><span class="p">(</span><span class="n">hf_tokenizer</span><span class="o">=</span><span class="n">hf_tokenizer</span><span class="p">,</span> <span class="n">max_n</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea ">
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>text</th>
      <th>category</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Raising Victor Vargas: A Review&lt;br /&gt;&lt;br /&gt;You know, Raising Victor Vargas is like sticking your hands into a big, steaming bowl of oatmeal. It's warm and gooey, but you're not sure if it feels right. Try as I might, no matter how warm and gooey Raising Victor Vargas became I was always aware that something didn't quite feel right. Victor Vargas suffers from a certain overconfidence on the director's part. Apparently, the director thought that the ethnic backdrop of a Latino family on the lower east side, and an idyllic storyline would make the film critic proof. He was right, but it didn't fool me. Raising Victor Vargas is the story about a seventeen-year old boy called, you guessed it, Victor Vargas (Victor Rasuk) who lives his teenage years chasing more skirt than the Rolling Stones could do in all the years they've toured. The movie starts off in `Ugly Fat' Donna's bedroom where Victor is sure to seduce her, but a cry from outside disrupts his plans when his best-friend Harold (Kevin Rivera) comes-a-looking for him. Caught in the attempt by Harold and his sister, Victor Vargas runs off for damage control. Yet even with the embarrassing implication that he's been boffing the homeliest girl in the neighborhood, nothing dissuades young Victor from going off on the hunt for more fresh meat. On a hot, New York City day they make way to the local public swimming pool where Victor's eyes catch a glimpse of the lovely young nymph Judy (Judy Marte), who's not just pretty, but a strong and independent too. The relationship that develops between Victor and Judy becomes the focus of the film. The story also focuses on Victor's family that is comprised of his grandmother or abuelita (Altagracia Guzman), his brother Nino (also played by real life brother to Victor, Silvestre Rasuk) and his sister Vicky (Krystal Rodriguez). The action follows Victor between scenes with Judy and scenes with his family. Victor tries to cope with being an oversexed pimp-daddy, his feelings for Judy and his grandmother's conservative Catholic upbringing.&lt;br /&gt;&lt;br /&gt;The problems that arise from Raising Victor Vargas are a few, but glaring errors. Throughout the film you get to know certain characters like Vicky, Nino, Grandma,</td>
      <td>negative</td>
    </tr>
    <tr>
      <th>1</th>
      <td>THE SHOP AROUND THE CORNER is one of the sweetest and most feel-good romantic comedies ever made. There's just no getting around that, and it's hard to actually put one's feeling for this film into words. It's not one of those films that tries too hard, nor does it come up with the oddest possible scenarios to get the two protagonists together in the end. In fact, all its charm is innate, contained within the characters and the setting and the plot... which is highly believable to boot. It's easy to think that such a love story, as beautiful as any other ever told, *could* happen to you... a feeling you don't often get from other romantic comedies, however sweet and heart-warming they may be. &lt;br /&gt;&lt;br /&gt;Alfred Kralik (James Stewart) and Clara Novak (Margaret Sullavan) don't have the most auspicious of first meetings when she arrives in the shop (Matuschek &amp; Co.) he's been working in for the past nine years, asking for a job. They clash from the very beginning, mostly over a cigarette box that plays music when it's opened--he thinks it's a ludicrous idea; she makes one big sell of it and gets hired. Their bickering takes them through the next six months, even as they both (unconsciously, of course!) fall in love with each other when they share their souls and minds in letters passed through PO Box 237. This would be a pretty thin plotline to base an entire film on, except that THE SHOP AROUND THE CORNER is expertly fleshed-out with a brilliant supporting cast made up of entirely engaging characters, from the fatherly but lonely Hugo Matuschek (Frank Morgan) himself, who learns that his shop really is his home; Pirovitch (Felix Bressart), Kralik's sidekick and friend who always skitters out of the room when faced with the possibility of being asked for his honest opinion; smarmy pimp-du-jour Vadas (Joseph Schildkraut) who ultimately gets his comeuppance from a gloriously righteous Kralik; and ambitious errand boy Pepi Katona (William Tracy) who wants nothing more than to be promoted to the position of clerk for Matuschek &amp; Co. The unpretentious love story between 'Dear Friends' is played out in this little shop in</td>
      <td>positive</td>
    </tr>
  </tbody>
</table>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Using the <a href="/blurr/modeling#HF_BaseModelWrapper"><code>HF_BaseModelWrapper</code></a> approach ...</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">model</span> <span class="o">=</span> <span class="n">HF_BaseModelWrapper</span><span class="p">(</span><span class="n">hf_model</span><span class="p">)</span>

<span class="n">learn</span> <span class="o">=</span> <span class="n">Learner</span><span class="p">(</span><span class="n">dls</span><span class="p">,</span> 
                <span class="n">model</span><span class="p">,</span>
                <span class="n">opt_func</span><span class="o">=</span><span class="n">partial</span><span class="p">(</span><span class="n">Adam</span><span class="p">,</span> <span class="n">decouple_wd</span><span class="o">=</span><span class="kc">True</span><span class="p">),</span>
                <span class="n">loss_func</span><span class="o">=</span><span class="n">CrossEntropyLossFlat</span><span class="p">(),</span>
                <span class="n">metrics</span><span class="o">=</span><span class="p">[</span><span class="n">accuracy</span><span class="p">],</span>
                <span class="n">splitter</span><span class="o">=</span><span class="n">hf_splitter</span><span class="p">)</span>


<span class="n">learn</span><span class="o">.</span><span class="n">create_opt</span><span class="p">()</span>             <span class="c1"># -&gt; will create your layer groups based on your &quot;splitter&quot; function</span>
<span class="n">learn</span><span class="o">.</span><span class="n">freeze</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><code>.to_fp16()</code> requires a GPU so had to remove for tests to run on github</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Using <a href="/blurr/modeling#HF_BaseModelCallback"><code>HF_BaseModelCallback</code></a> approach for improved integration with fastai ...</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">learn</span> <span class="o">=</span> <span class="n">Learner</span><span class="p">(</span><span class="n">dls</span><span class="p">,</span> 
                <span class="n">hf_model</span><span class="p">,</span>
                <span class="n">opt_func</span><span class="o">=</span><span class="n">partial</span><span class="p">(</span><span class="n">Adam</span><span class="p">,</span> <span class="n">decouple_wd</span><span class="o">=</span><span class="kc">True</span><span class="p">),</span>
                <span class="n">loss_func</span><span class="o">=</span><span class="n">CrossEntropyLossFlat</span><span class="p">(),</span>
                <span class="n">metrics</span><span class="o">=</span><span class="p">[</span><span class="n">accuracy</span><span class="p">],</span>
                <span class="n">cbs</span><span class="o">=</span><span class="p">[</span><span class="n">HF_BaseModelCallback</span><span class="p">],</span>
                <span class="n">splitter</span><span class="o">=</span><span class="n">hf_splitter</span><span class="p">)</span>


<span class="n">learn</span><span class="o">.</span><span class="n">create_opt</span><span class="p">()</span>             <span class="c1"># -&gt; will create your layer groups based on your &quot;splitter&quot; function</span>
<span class="n">learn</span><span class="o">.</span><span class="n">freeze</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># learn.summary()</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">learn</span><span class="o">.</span><span class="n">opt</span><span class="o">.</span><span class="n">param_groups</span><span class="p">))</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>4
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1">#slow</span>
<span class="n">learn</span><span class="o">.</span><span class="n">lr_find</span><span class="p">(</span><span class="n">suggestions</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea ">

</div>

</div>

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>SuggestedLRs(lr_min=6.309573450380412e-08, lr_steep=0.033113110810518265)</pre>
</div>

</div>

<div class="output_area">



<div class="output_png output_subarea ">
<img src="data:image/png;base64,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
"
>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1">#slow</span>
<span class="n">learn</span><span class="o">.</span><span class="n">fit_one_cycle</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="n">lr_max</span><span class="o">=</span><span class="mf">1e-3</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea ">
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: left;">
      <th>epoch</th>
      <th>train_loss</th>
      <th>valid_loss</th>
      <th>accuracy</th>
      <th>time</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>0</td>
      <td>0.695509</td>
      <td>0.635903</td>
      <td>0.555000</td>
      <td>00:19</td>
    </tr>
    <tr>
      <td>1</td>
      <td>0.556205</td>
      <td>0.521889</td>
      <td>0.805000</td>
      <td>00:19</td>
    </tr>
    <tr>
      <td>2</td>
      <td>0.484099</td>
      <td>0.493027</td>
      <td>0.820000</td>
      <td>00:19</td>
    </tr>
  </tbody>
</table>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>And here we creat a @typedispatched impelmentation of <code>Learner.show_results</code>.</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">learn</span><span class="o">.</span><span class="n">show_results</span><span class="p">(</span><span class="n">hf_tokenizer</span><span class="o">=</span><span class="n">hf_tokenizer</span><span class="p">,</span> <span class="n">max_n</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea ">

</div>

</div>

<div class="output_area">


<div class="output_html rendered_html output_subarea ">
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>text</th>
      <th>category</th>
      <th>target</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>The trouble with the book, "Memoirs of a Geisha" is that it had Japanese surfaces but underneath the surfaces it was all an American man's way of thinking. Reading the book is like watching a magnificent ballet with great music, sets, and costumes yet performed by barnyard animals dressed in those costumesÂ—so far from Japanese ways of thinking were the characters.&lt;br /&gt;&lt;br /&gt;The movie isn't about Japan or real geisha. It is a story about a few American men's mistaken ideas about Japan and geisha filtered through their own ignorance and misconceptions. So what is this movie if it isn't about Japan or geisha? Is it pure fantasy as so many people have said? Yes, but then why make it into an American fantasy?&lt;br /&gt;&lt;br /&gt;There were so many missed opportunities. Imagine a culture where there are no puritanical hang-ups, no connotations of sin about sex. Sex is natural and normal. How is sex handled in this movie? Right. Like it was dirty. The closest thing to a sex scene in the movie has Sayuri wrinkling up her nose and grimacing with distaste for five seconds as if the man trying to mount her had dropped a handful of cockroaches on her crotch. &lt;br /&gt;&lt;br /&gt;Does anyone actually enjoy sex in this movie? Nope. One character is said to be promiscuous but all we see is her pushing away her lover because it looks like she doesn't want to get caught doing something dirty. Such typical American puritanism has no place in a movie about Japanese geisha.&lt;br /&gt;&lt;br /&gt;Did Sayuri enjoy her first ravishing by some old codger after her cherry was auctioned off? Nope. She lies there like a cold slab of meat on a chopping block. Of course she isn't supposed to enjoy it. And that is what I mean about this movie. Why couldn't they have given her something to enjoy? Why does all the sex have to be sinful and wrong?&lt;br /&gt;&lt;br /&gt;Behind Mameha the Chairman was Sayuri's secret patron, and as such he was behind the auction of her virginity. He could have rigged the auction and won her himself. Nobu didn't even bid. So why did the Chairman let that old codger win her and, reeking of old-man stink, get his fingers all over her naked body? Would any woman ever really forgive a man for that?&lt;br /&gt;&lt;br /&gt;Let's</td>
      <td>negative</td>
      <td>negative</td>
    </tr>
    <tr>
      <th>1</th>
      <td>How viewers react to this new "adaption" of Shirley Jackson's book, which was promoted as NOT being a remake of the original 1963 movie (true enough), will be based, I suspect, on the following: those who were big fans of either the book or original movie are not going to think much of this one...and those who have never been exposed to either, and who are big fans of Hollywood's current trend towards "special effects" being the first and last word in how "good" a film is, are going to love it.&lt;br /&gt;&lt;br /&gt;Things I did not like about this adaption:&lt;br /&gt;&lt;br /&gt;1. It was NOT a true adaption of the book. From the articles I had read, this movie was supposed to cover other aspects in the book that the first one never got around to. And, that seemed reasonable, no film can cover a book word for word unless it is the length of THE STAND! (And not even then) But, there were things in this movie that were never by any means ever mentioned or even hinted at, in the movie. Reminded me of the way they decided to kill off the black man in the original movie version of THE SHINING. I didn't like that, either. What the movie's press release SHOULD have said is..."We got the basic, very basic, idea from Shirley Jackson's book, we kept the same names of the house and several (though not all) of the leading character's names, but then we decided to write our own story, and, what the heck, we watched THE CHANGELING and THE SHINING and GHOST first, and decided to throw in a bit of them, too."&lt;br /&gt;&lt;br /&gt;2. They completely lost the theme of a parapyschologist inviting carefully picked guest who had all had brushes with the paranormal in their pasts, to investigate a house that truly seemed to have been "born bad". No, instead, this "doctor" got everyone to the house under the false pretense of studying their "insomnia" (he really invited them there to scare them to death and then see how they reacted to their fear...like lab rats, who he mentioned never got told they are part of an experiment...nice guy). This doctor, who did not have the same name, by the way, was as different from the dedicated professional of the original movie as night from day.&lt;br /&gt;&lt;br /&gt;3</td>
      <td>negative</td>
      <td>negative</td>
    </tr>
  </tbody>
</table>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">learn</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="s1">&#39;I really liked the movie&#39;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea ">

</div>

</div>

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>(&#39;positive&#39;, tensor(1), tensor([0.4650, 0.5350]))</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">learn</span><span class="o">.</span><span class="n">unfreeze</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1">#slow</span>
<span class="n">learn</span><span class="o">.</span><span class="n">fit_one_cycle</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="n">lr_max</span><span class="o">=</span><span class="nb">slice</span><span class="p">(</span><span class="mf">1e-6</span><span class="p">,</span> <span class="mf">1e-3</span><span class="p">))</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea ">
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: left;">
      <th>epoch</th>
      <th>train_loss</th>
      <th>valid_loss</th>
      <th>accuracy</th>
      <th>time</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>0</td>
      <td>0.359278</td>
      <td>0.318360</td>
      <td>0.910000</td>
      <td>00:49</td>
    </tr>
    <tr>
      <td>1</td>
      <td>0.158295</td>
      <td>0.227441</td>
      <td>0.920000</td>
      <td>00:50</td>
    </tr>
    <tr>
      <td>2</td>
      <td>0.141344</td>
      <td>0.297240</td>
      <td>0.920000</td>
      <td>00:50</td>
    </tr>
  </tbody>
</table>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">learn</span><span class="o">.</span><span class="n">recorder</span><span class="o">.</span><span class="n">plot_loss</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_png output_subarea ">
<img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAXQAAAD4CAYAAAD8Zh1EAAAABHNCSVQICAgIfAhkiAAAAAlwSFlzAAALEgAACxIB0t1+/AAAADh0RVh0U29mdHdhcmUAbWF0cGxvdGxpYiB2ZXJzaW9uMy4yLjEsIGh0dHA6Ly9tYXRwbG90bGliLm9yZy+j8jraAAAgAElEQVR4nO3deXxU1dnA8d+ZmUz2fScJJJCw7yCLCIIroOJetWrVWq1brW1ti29ba61t1b71rW2tVVtFa5Uq7orgBqKISNjDEkggkIWQBbKvMznvH3cymUASJmGSySTP9/PJpzN37tw5l8ZnTp5zznOU1hohhBC+z+TtBgghhPAMCehCCDFASEAXQogBQgK6EEIMEBLQhRBigLB464NjYmJ0amqqtz5eCCF80ubNm8u01rEdvea1gJ6amkpmZqa3Pl4IIXySUupQZ69JykUIIQYICehCCDFASEAXQogBwms5dCGE6K7m5mYKCgpoaGjwdlN6XUBAAMnJyfj5+bn9HgnoQgifUVBQQGhoKKmpqSilvN2cXqO1pry8nIKCAtLS0tx+n6RchBA+o6Ghgejo6AEdzAGUUkRHR3f7LxEJ6EIInzLQg3mrntynBPQurM8pI7u42tvNEEIIt0hA78L1/9zIhX9e55Fr5R+ro6bR5pFrCSG8o6Kigr///e/dft/ixYupqKjohRa1JwHdDSVVpzeirrVm7uNruP6fGz3UIiGEN3QW0G22rjtrK1euJCIiorea5SQB3Q17TzPtUlHXDMD2/AqeXZfriSYJIbxg6dKl5ObmMnnyZM444wzmzp3LkiVLGDt2LACXXXYZ06ZNY9y4cTz77LPO96WmplJWVkZeXh5jxozhtttuY9y4cVxwwQXU19d7rH0ybbETTbYW5+O88lrm0WEtHLfkH69zPv79yr3cPm/EabVNCAG/eW8Xu4uqPHrNsUPC+PUl4zp9/dFHHyUrK4tt27axdu1aLrroIrKyspxTC59//nmioqKor6/njDPO4MorryQ6OrrdNfbv38+rr77Kc889x7e+9S3eeOMNbrjhBo+0X3ronahravsT6kBpbY/en1dmvC//mOe+gYUQ/ceMGTPazRP/y1/+wqRJk5g1axb5+fns37//pPekpaUxefJkAKZNm0ZeXp7H2iM99E64DmDuLKyk2d6Cn9n977/7lm/jo91H2f+7RRypbB/Qu3stIcTJuupJ95Xg4GDn47Vr1/LJJ5+wYcMGgoKCmD9/fofzyP39/Z2PzWazR1MuElU6UdtoByAswMLmQ8e57aXulfrNPHQcgKKKeuqbjGsNjQoC8PifiUKIvhEaGkp1dcdjapWVlURGRhIUFMTevXv5+uuv+7h1EtA7VetIuaTHhQCwNru0XRrmVBLDAwA4fKyOBpsds0nx9t1zUAru+s8WNuSWe77RQoheFR0dzZw5cxg/fjw//elP2722cOFCbDYbY8aMYenSpcyaNavP2ycpl07UOlIudy9I595Xt1LbZOf8J9bx5c8XoJSiydbCSxvyuHbGUEL8T/5nTAwPYFdRlRHQm1sIsJiICrYyKj6UvcXVXPfc1+Q9elEf35UQ4nS98sorHR739/fnww8/7PC11jx5TEwMWVlZzuP333+/R9vmVg9dKbVQKZWtlMpRSi3t4PWblVKlSqltjp/vebSVfcxmb6GmwQjoieGBrLjzTAAKK+rZWVgJwLKvDvLIB3t4dePhDq8RHWzkyQqO19PQbCfAzwzQYfAXQghPOGVAV0qZgaeARcBY4Dql1NgOTv2v1nqy4+efHm6n24orT7+sZvovPuTO/2wBIDTAwpjEMNbePx/AWQpgfY6RMmmyt3R4DVuLBuBoZYPRQ3cEdNfB0BMHS4UQ4nS400OfAeRorQ9orZuA5cClvdusnvn72hxm/eFT9h/t+UKgoy6rQkP8LQyJCAQgOTIQq9nET1fs4Ll1B2hoNgY6O1tFamsxAn1xVQMNNjv+fsY/9W8vG4/FZBTd+fU7u3rcTiGEOJE7AT0JyHd5XuA4dqIrlVI7lFIrlFIpHV1IKXW7UipTKZVZWlrag+Z27fFV2QAcrWrs8TW257fVWxifFIbZEXwtZhPhQUah+d+t3OMcND3SyV8EzY6e+9GqBhqb7QRYjB56elwI+x5ZxPCYYPKPSw9dCOE5nprl8h6QqrWeCHwMvNjRSVrrZ7XW07XW02Nje77ysiMtjhQHQHVDc4+vk1Na43y8aHxiu9f+9+pJDIs2ph4WVxpfGkWdpE2abI6US1WjI+XS9k9tMinmjYzlcHktWusO3y+EEN3lTkAvBFx73MmOY05a63KtdWu3+J/ANM80z31HXFIf1Q09r2pYVFFPgJ+J5bfP4juzh7V77eyRsTx4sTF8UFZj3O7B0o6DcmvKpabRxq6iSmcOvdXQqCBqm+yU1zb1uK1CCOHKnYC+CchQSqUppazAtcC7ricopVy7skuAPZ5ronsOuizPrzqNHnpRRQNpMSHMGt7xrihjEsOcj4OtZmqb7BRWnNxLb7a3kBwZiFJwvK75pIA+PikcgI92He1xW4UQ/VtIiLGOpaioiKuuuqrDc+bPn09mZvcWLnbmlAFda20D7gFWYwTq17TWu5RSDyulljhOu1cptUsptR24F7jZI63rhvLatrx5VX33A3pJdQPvbi+iqKKepIiATs9LDA8gLMCYejh1WCQA+zoYhG22a5IjAxmdYHwBuKZcAM5IjSQ9LoTVu4q73VYhhG8ZMmQIK1as6PXPcSuHrrVeqbUeqbUeobX+nePYg1rrdx2PH9Baj9NaT9JaL9Ba7+3NRr+1teCkmSx1juX1AFU9SLnc+fIW7n11K3uLq50zWzqilHL20qekGPWN9x2tOem81notM9OiADCb2v9TK6VIjw3psHcvhOifli5dylNPPeV8/tBDD/HII49w7rnnMnXqVCZMmMA777xz0vvy8vIYP348APX19Vx77bWMGTOGyy+/fHCXz9Va86P/bgdot9KydWVnWIClRymX/GNtJW67CuhgpF02HjxGYkQgCWEB7OugXrrNrp0BfdlXeR1OpUyKDOTzfaVorQfNPolCeMyHS6F4p2evmTABFj3a6cvXXHMN9913H3fffTcAr732GqtXr+bee+8lLCyMsrIyZs2axZIlSzr9b/rpp58mKCiIPXv2sGPHDqZOneqx5vtcQK+q77j33dpDTwgP6PScrlgtbT3o1josnRmTGApAsL+FjPgQdhZWnhSUjR66Yoajh17ZQRooKSKQ+mY7x+uaiQq2drvNQoi+NWXKFEpKSigqKqK0tJTIyEgSEhL40Y9+xLp16zCZTBQWFnL06FESEhI6vMa6deu49957AZg4cSITJ070WPt8LqCX1nQ8x7y2yYa/o15KZX33Z474uwT0pFP00KcNi8RsUgyNCmLh+AR+8VYWa7NLWTA6znlOs70Fi9lEdIg/D1481hnYXSVFGp+Tf6xOAroQ3dVFT7o3XX311axYsYLi4mKuueYa/vOf/1BaWsrmzZvx8/MjNTW1w7K5fcHnqi2WuQT0PUfaytDWNdoJ9rcQHezfo6mANpd57ImnCOjpcaFs+dX5TE6J4OppKaREBfLXz9oXsm+2a6yOZf7fPSvNOavFVYajkmNHg6pCiP7pmmuuYfny5axYsYKrr76ayspK4uLi8PPzY82aNRw6dKjL98+bN89Z4CsrK4sdO3Z4rG0+F9DLa9qC9W/ea1s6X9tkI8hqJirYyrEuAvqy9Qf54fKt7Y4121soqWpkUkoEDywazZBTpFwAwgONVaNWi4lF4xPJKqpqt7ip2d7iXOLfmWHRwfhbTM76MEKI/m/cuHFUV1eTlJREYmIi119/PZmZmUyYMIGXXnqJ0aNHd/n+O++8k5qaGsaMGcODDz7ItGmeW7bjcymX1h66v8XEofK2gcy6RjvBVgtRwVYq6po73RXoofd2A/D4VRPxt5ixt2je31FEfbOd+87LYMGouJPecypDo4JosrVQXNXgHFBttmv8LF1/X5pNioz4ELKlhy6ET9m5s20wNiYmhg0bNnR4Xk2NMQMuNTXVWTY3MDCQ5cuX90q7fK6HHhPiz5z0aH5ywUiOVDbw/JcH2XzomNFD9zcTHWLkoo/Xte+lV9Y3M/pXbbWKD5fX0WxvYeJDq/nRf7fjbzExf2TPyhG0lgNw/YJptrfgd4oeOsCo+DDpoQshPMLnAvpFExP5z/dmERtq1Bt/+P3dXPn0Buqa7IT4W5yDiyemXQ6XGxtNtMotreG1zHxqHbNjooKtPZ46mBpt7Ct4oKxtPrrNzX1DRyWEUFLdyHEpASCEOE0+F9Bbhfr7tXu+Lb+CYKuF+DAj/91aF91mb+GpNTkcdswzf+m7Mwj0M/PPLw7yi7fadg5pOY0iWcmRgcSEWMnMO+485k7KBWCUYyVp9tFqHl+1lwfe9PC8WiEGmMFS0K4n9+lzOfRWIQHtm25v0VwyaYgz/dEawD/MKuaPq7OJcaRikiIDuXTyEJZvym/3/nqXlabdpZQx3/ybg8cAYxpik9spF2NOe3ZxNX9fmwvAH66Y0OO2CDGQBQQEUF5eTnR0x7WWBgqtNeXl5QQEnHqChiufDeihASc3febwKKKDrQRZzeSVGQG9wpFLL3PMjokMsnLj7GEs35RPgJ+J2cOjWZNdSoOt452H3DUjNYqVO4tZ/OQX7HZMp7S4kXKJD/MnPNCv3cCozTGHXQjRXnJyMgUFBfTGfgr9TUBAAMnJyd16j+8G9BNSLmAEeaUUw6KDOVhWQ1VDM29tbav0q5Qx3TAq2Mor35vJJEctlnG/Xk3MaS7smTk8GsAZzAGGxwaf8n1KKTLiQsgpacu/H6lsICUq6LTaI8RA5OfnR1pamreb0W/5bkDvoIfu79gVaExiKG9uKWTiQx+1ez0i0M+5A9GZ6THO47+7fDxnjojhdIxOCOWxKyeQU1LDc18cBHB7CuTQqCC+PlDufH74WJ0EdCFEt/lsQD8xh+5qytBI3txSeNLxuNCO81HXzxzW4fHuUEpxzRlDAfjR+SMpr2ki2N+9f97kyMB2G3Rsy69gfFK4c/GSEEK4w2cTtV1NCZw/Mpa0mLZ0R+vOQ1OGRvR6uwCCrJZu9bCTo4JwHdD+4+psJv3mo87fIIQQHfDZgN6VlKgg1tw/3/n8J+eP4uKJidxx9gjvNaoLKZEdB//WjaaFEMIdAzKgt4oJMRYfhQf58bdvTyU15tSDlN6Q7ijSBRDoslVdXlltR6cLIUSHfDaHDmA1m2jqohe77mfzafGBNQitc+QBRieGsvVwBQD7S2rIcMxTF0KIU/HpHnpksDFo+OgVE9qlWFoFWS2EuDkw6U1KKWakGvXSW/8X2teGEUKIU+n/0a4LCeGBHK1qZGJyRLtBUF/09xum0qI1u4qqeGbdAQAOH5OUixDCfT7dQ3/q21P43llpjErw/bRETIg/caEBLBgVx79vncHE5HBn+QIhhHCHTwf05MggfnnxWOdioYFibkYs6XEhrM8p57+bDjuPZ+Yd439XZ3uxZUKI/synA/pA1rrK9OdvtFVfvPXFTP62JofS6o73VRVCDG4S0Pup88bEOx/XNNoAo5AXwOZDx7zSJiFE/yYBvZ8KtJr563VTACg4buTSh8cY89WzCqs6fZ8QYvCSgN6PtZYP2OUI4LYWY879gbKaQVPkXwjhPgno/VhGXAhRwVaeWpMDQJ1jE46VO4t57osD3myaEKIfkoDejwX7W7jlzFQOlNVS02hzBnSAx1fJbBchRHsS0Pu51qX/B0trqW+ykxhulAC2tWhSl35Ao63nW+cJIQYWCej93AjHrke5pTXUNduYmRbFU9+e6nz9sJQHEEI4SEDv54ZGB2E2KQ6U1lDfZCfQamFkfFt1xtxSKQ8ghDBIQO/n/C1mhkYFkVtaS12TnWCruV0Z4ANlNV28WwgxmEhA9wHDY4LJKamhvtlOkNWMn9nEV0vPISzAwuqsYirqmrzdRCFEPyAB3QeMTwon+2g1WkOg1SiQOSQikPS4ELYXVHLLsk1ebqEQoj+QgO4Dlkwe4nx8zug45+OqBqMkQOuGGEKIwU0Cug8YERvCW3edydr757crFXz5lCTA2LlJCCHcigRKqYVKqWylVI5SamkX512plNJKqemea6IAmDI08qQ9Ue88ewT3LEinyd5CZX2zl1omhOgvThnQlVJm4ClgETAWuE4pNbaD80KBHwIbPd1I0TGTSTEpJQKAA6XtZ7tIrRchBh93eugzgByt9QGtdROwHLi0g/N+CzwGNHiwfeIUhjsXHrXNR/90z1HSHlhJvux4JMSg4k5ATwLyXZ4XOI45KaWmAila6w+6upBS6nalVKZSKrO0tLTbjRUnGxoVhMWkyHXpoS9909gU46vcMm81SwjhBac9mqaUMgFPAD851bla62e11tO11tNjY2NP96MF4Gc2MSw6yJlyqWpodu5otOdItTebJoToY+4E9EIgxeV5suNYq1BgPLBWKZUHzALelYHRvjMiNsSZctmcd9x5fEeBTGcUYjBxJ6BvAjKUUmlKKStwLfBu64ta60qtdYzWOlVrnQp8DSzRWmf2SovFSUbEhXCovJZmewulNUbv/Pyx8ew+UoXN3tKtax2taqDJ1r33CCH6h1MGdK21DbgHWA3sAV7TWu9SSj2slFrS2w0UpzY6IZRmu2bvkWpqHIuNzhwRTUNzCzml7td60Voz8/efcttL8l0shC+yuHOS1nolsPKEYw92cu7802+W6I7ZI6IB+CKnFJtdtzu2s6CS0Qlhbl2nvtmorf75PhmwFsIXyRLDASAuNIC0mGC251dQ02gj0M9MRlwowVYzOwsr3b5Oa+8eoLpBFioJ4WskoA8QI2KDySuro7qhmZAAC2aTYtyQ8G4F9OrGtoCeVyZz2IXwNRLQB4i0mGCyj1bz6jf5ztouE5LD2V3k/sCoaw9d6qwL4XskoA8QaTFtuxgVVtQDMCEpnEZbC/uOuheca1166LITkhC+RwL6AJF2QuEugMmOOi/b8t2bj+6actkpc9iF8DkS0AeI1pouroZFBxEdbGXzoeMdvONkrSmXmWlRbM2vcBb4Kq1u5I+r93Z7TrsQom9JQB8g4kL9nY9f+d5MAJRSTEwOZ1eRewOjNY4e+ryRsVTUNXOwzEi7PL5qL0+tyeXTvSUAlFQ38N1lm1j+zWFaWqSqoxD9hVvz0EX/p5TipxeOYkRsMGemxziPZ8SHsj63HHuLxmxSXV6jNaCfPTKWP67O5t3tRTTbW2gN2cWVRiHN1VnFfLa3hM/2lhDkb2HJpCGdXFEI0ZckoA8gdy9IP+lYelwITbYW8o/VnbRBxolqG22YTYqxiWGE+lv48yf7ARiTaCxMKjheh9a63YDp7qIqCehC9BOSchng0uOM2S/7S04906WhuYVAPzMmkyI9vm3WzJ4jVQBsOVzB6l1HWfZVHmDk6P/xeS4X/eULzzdcCNFtEtAHuLaAfupSug02OwF+xq9EcmTQSa9vy68gy2Wh0rmj4wHYVVQlK0uF6AckoA9wYQF+xIf5k+NWD92Ov8UMtE2DvPfcDOfr9hbdboB1WHRb0M90cybNqZTXNHL7S5nOmu5CCPdJQB8EMuJC3Q7orT30O88ewTt3z+HuBSPanfNVbjkAn/x4HldNS+aKKcbmVbuLqnrcviOV9RyvbQLgra2FfLT7KE+tyenx9YQYrCSgDwLpcSHklNSccuPohuYWAq1GDz3QamZSSgT+FjNPXz+V9+45i5gQK422FmJD/UmPCyXY38IT10wmJSqQ3Ue6F9AbbXY+3HmED3ceYfYfPuOCP68DoNlRLbKkWramFaK7ZJbLIJAeF0Jdk52iygaSIgI7Pa+h2U6AI+XiatGERABGJYRSllNOVJC13esTkyP4cn8ZZTWNxIT4n/T+jry7rYifrtjhfN6aYsk/bhQFyy6W7fOE6C7poQ8CGY6B0X2dBMmvD5Sz+Mkv+Cq3nAC/kwN6q1HxxvTF8EC/dsfvOzeDyvpmln9z2O02FVWc3AM/XF7HOkct9tzSWirqmty+nhBCAvqgMC4pHJOCrZ3UdFmVVexMmXQV0FvLC4xMCGl3PCM+lBmpUby/44hb7dlVVMn/fbLP8XkmLnHMY7/oL19QXNnA9+cNB2Dywx+zs8D98r9CDHaSchkEQvwtjIwPZevhjmei1LgU5WodFO3IZVOSaLS1cP3MoSe9Nic9hj9/uo/qhmZCA/w6eHeb37y72/l4728X0WxvYW12CdUNNq6YksTPF47ms70l7C+pYU12CROSw091i0IIpIc+aEwdFsm2wxUd1l5xrYPeVQ89xN/CrWeldXjO5KERaI1bPeq4sPZ5dj+ziTGObfLGJYVjMinev/cs4sP82VvcfrBVascI0TkJ6IPE1KGRVDfaOlwx6tpDd62J3h2Tk41SvZ2ldVxFB1tPOnb2qFigbSGUv8XMWemxrM0u5UilUd/9b5/tZ9SvPqTBsfepEKI9CeiDxJShRsDd3kHArXbUcIG2WSbdFR7kx/CYYFbvKj7l9MjWzahf/O4M57E7zh7By7fOZF5GW2Gx+87LoMnWwj+/OAjAy18fptmueXtrYY/aKMRAJwF9kEiLDibYanau9NyWX+Gsb17T0MwUx2YYx2t7voR/weg4dhRU8n+Ool6dqWm0kR4XwtkjY53HzCbFWRkxKNVWETIlKojzx8bz3vYitNaMTgx1tl0IcTIJ6IOEyaQYOySMbfkVFFbUc9lT6/mft3YCUNtoZ3hsMLfPG87TN0zt8Wc8sGg0C0bFsmz9wS576dUNNkID3BuPn5kWRUl1I8VVDVQ7cv27TmNVqhADmQT0QeTcMfFsL6hk08FjALyWWcDmQ8cormogNMCP/1k8homOXHhPWMwmzh+bQFWDjfxj9Z2eV91gI8TfvYA+yfGXw5ZDFc4CYHuLq6hvkjy6ECeSgD6IXDk1GTDqpTiPPb0BgIo6z1RLHJ9kzFb515cHOg26NY3u99DHJ4UTFmBhjWNaY0yIP8123ekUTCEGMwnog0hsqD+jE0L53LEa09XQqJPL5fbEaMf0wxc3HOL+Fds7PKemwUaof9dz1Vv5mU2cPSqOt7cWcqSygXNHx6EUbMqTgC7EiWRh0SAzbVgkex0lAP5y3RQq6ppYMCqO+LAAj1zfajERHWylvLaJD3Yc4a/XakwnbH1X3dBMiJs9dIDzxsTx3vYiAOLDA0iLCSbLzX1ShRhMpIc+yLRuJwcwa3gU35mdSkpUEFaL534VVtx5JgvHJQBQcLx9Lt3eoqltsrudQwdj9kyrvLJaJiSFt9toQwhhkIA+yIxxTP0D3E57dFdaTDB3zDfqqO8+UsX6nDJ+9N9taK2pbTJmqribQwdjk47MX55HkNXMtTNSGD8knCOVDZTVyCYYQriSlMsgMyqhrYfeVd0Wt+15D7SGUYvA3PYFMSo+FJMy9iN9Zl0uDc0t3HtuhvMvge4EdICYEH92P7wQAIWRwskqrGT+qLiu3ibEoCI99EHGNdXhuoinx755Dl67EZ4YC5/8Bo4ZqzoDrWZSY4LZc6QKP5Pxa7bgf9dS6ZhNE3Iafx2Mc8ykkfnoQrQnPXRxem58C3I+gc3LYP2f4csnYPgCmH4L4xISWbuvnGqX+jCbDxlz4LvbQ3cVFuBHanSQlNYV4gQS0AehL362gPJaD20eYTLDyAuNn8pC2PoybHkJXvsOj1mjWWafw3K1gJsuWsBv39/Nr97ZBdCtWS4dGZcU3mFdGiEGM0m5DEIpUUFMTun5itBOhSfB/J/DfTvg26/TlDCV283vs87/R3w39z4Wm77GD8egaDdmuXRkQlI4BcfbNpcWQkhAF73BZIaRFxD0nde4LeoF9o37IepYLn+3/oUN/vew1PIqYfX5p/UR44cYm15IHl2INm4FdKXUQqVUtlIqRym1tIPX71BK7VRKbVNKfamUGuv5pgpfY7WYeOGHlzHy6ofhh9t5MPQ3ZLaM4nvmD4hfNhteXAJZb4Kt+73s1hIDUgJAiDanDOhKKTPwFLAIGAtc10HAfkVrPUFrPRl4HHjC4y0Vvs1k5q7v3UHVkhew3L8HzvmlMSNmxS3wxBj46FdQnuv25SKCrExKieCj3Ud7sdFC+BZ3eugzgByt9QGtdROwHLjU9QSttevfvcGA7BMmTpIQHsC3zkiB0ASY91P44Xa44Q0YNhs2PAV/nQrLLoadK8B26kVDF01IYGdhJYfLe7YphxADjTsBPQlwTXgWOI61o5S6WymVi9FDv9czzRMDmskE6efBNS/Dj3fDuQ9CxWF441b402hY/Qsoy+n07YvGJwKwateRvmqxEKfP3tyjNKM7PDYoqrV+Sms9Avg58MuOzlFK3a6UylRKZZaWnlzxTwxioQkw9ydw7zZjbnvaXNj4D/jbtE577SlRQQyPCeabg5JHF/1cQ6XxO7ziVnh8BOx+u1c+xp25Y4VAisvzZMexziwHnu7oBa31s8CzANOnT5e0jDiZyQQjzjF+akoc89pfNHrtgVEw+dsw9SaIHQnAlKGRrM0uoaXl5KqOQnhVxWHIXgXZH0Del9Big6AYGHsJRI3olY90J6BvAjKUUmkYgfxa4NuuJyilMrTWrRtJXgR0vamkEO4IiYO5P4Y598HBz43VqBv/ARv+BsPmwLSbmT9iOm9sKWB9bhlzM2JPeUkheo3WcGQbZH8Ie1fCUWOLR2JGwuy7YdRFkDzdmNbbS04Z0LXWNqXUPcBqwAw8r7XepZR6GMjUWr8L3KOUOg9oBo4DN/Vai8XgYzLBiAXGT00JbHvFCO5v3sbFgZFUBs7ho7UNzM240tstFYONrREOfgHZK41AXl0EygQps+D838KoxRCT3mfNUV1t5tubpk+frjMzM73y2WIAaGmBvHWweRn23e9h1jYahswkYOatMHYJ+AV6u4VioKo7Bvs/MoJ4zqfQVAN+wZB+jhHAMy6A4Jhe+3il1Gat9fQOX5OALnxdaXE+zz/1e24LWkdUYwEERMCk62DazRA32tvNEwPBsQNtqZTDG0DbISQBRi00Uilp88DPM7t+nYoEdDHgXf739VgUvL7Qzlev/YmZDW00c5kAACAASURBVF9i1jbjT9/pt8DYS6XXLtzX0gKFmx2plJVQutc4HjfOqP0/ejEkTjHSgX2sq4Au1RbFgDA5JYJXvzmMbeiF3FFfz9jw21g+86CRa3/r+/Dhz4xe+9SbIF4qU4gONNfDgbWOIL4KaktAmSHVGIBn1CKITPVyI7smAV0MCJNTInhhfR57i6upbrSxqdRE/fS7CJx9jzFlbPMyyHzemCWTMtP4D3TsZWAN8nbThTfVlML+1UYqJfczsNWDf5ix4G3UYsg4DwIjvd1Kt0lAFwNCazngL/aXoTXYtSarqJIzUqOMRUppc6G2HLa/agT3t++EVUth4rUw7SaIH+fdGxB9p3RfWyol/xtAQ1gyTLnBSKUMOwssVm+3skckoIsBYWhUEJFBfqzb17YCeXt+hRHQWwVHw5n3GHOCD31lBPbNy+CbZyB5htFrH3e59NoHmha7EbizPzAGNssd5SQSJ8H8pUZPPGECeGJLRi+TgC4GBKUUk1IiWJvdFtC3dbajkVJGXjR1Dix6DLYvh80vwDt3waoHYOK3jOCeML5vGi88r7EGDqwxUin7V0NdOZj8jNkoM+8w8uHhyd5upcdJQBcDxpjEMGdAjw317zyguwqKgtl3waw7jelom5cZW+hteg6SphuBffwVYA3u1bYLD6guNnrg2R8ag5v2RggIh4wLjVTKiHMhIMzbrexVMm1RDBhHqxqY+ftPAbhiahJvbikk85fnse9oNX5mU/v0S1fqjsGO/0LmC1CWbQySTbjamP6YMKEX70B0i9ZQsqctlVK42TgeMQxGX2T0wofOBrOfd9vpYTJtUQwK8WEB/OT8kfzp432cNyaeN7cUsqOggu8uMzoOex5eSKDVjToaQVFGj33mHZC/0ei1b/sPZP4LkqY5cu1XgH9Ir96P6IC92fhLaq9jULPikHE8aRqc8ysjHx43ZkDkw3tCAroYUO45J50bZg3D38+E2aTYdrgt7fJlThnnj413/2JKwdBZxs+Fv4cdrxnB/d0fwKr/gYlXG8E9cZLH70O4aKiCnE+MAL7/I6MUrdkfhs83ireNXGiUXxYS0MXAopQiMtiYcjYlJYLnvjjofG3r4ePdC+iugqJg1h0w8/vGjInNy4wiYZnPw5Apjlz7leAfevo3IaAiH/atMoL4wS+gpRmComH0xUYqZcQ5Mq7RAcmhiwGrqKKesx77jBbHr3iov4WPf3w2CeEeqrlRfxx2vG7MkCnZDdYQI9c+7WYYMtkznzFYaA3FO9pSKcU7jOPR6UYaZdRiSJnRq6VnfYXk0MWgNCQikGnDItmUd5zb5qbx3BcH+XjPUW6cNcwzHxAYCTNvhxm3QcEmo9feOgUycbIR2CdcJb32ztiaIM+l9GxVIaCMlbznP+woPZvh7Vb6FAnoYkA7Z3Q8m/KOc87oeN7fcYSNB8o9F9BbKWX0HlNmGLn2na8bM2Tev8/YF3XCVUZwT5rq2c/1RfXHYf/Hjnz4J9BUDX5BRgplwS9g5IW9Wnp2oJOALga0788bztShEcwcHs3MtCjW55ajtUb11iyIwAijx37G94xpdJtfMAL8lheNwdNpN8P4qwb8fOh2jh10zA9faazQ1XYIiTfm949aDMPPlkqYHiI5dDFovPrNYR54cyef/uRsRsT24ZTDhkpHr32ZsS2ZXzBMuNKRa5868KbYtbRA0da2+eElu43jsWOMBT6jFhv37YXSswOB5NCFAGamGQuLNh441rcBPSDc6LFPvxUKtzh67SuMFakJExy59quN83xVcz0cXNdWeram2Cg9O+xMuPAPxkYQUcO93coBTwK6GDTSYoKJDfVn48Fyvj1zaN83QClInmb8tObaN78AH/wEPvqVkYKYdouxSMYXeu21ZbBvtRHEcz+D5jpjpo+z9Oz5xnRP0WckoItBQynFrOHRfH2gl/Po7ggIgzNuhenfNdITm5cZvfatL0P8BKOk78Rv9b9ee1lOWyolfyPoFghLgsnfNuaHp84Fi7+3WzloSUAXg8qs4VG8t72Ig2W1DO/LtEtnlDJmvyRNhQt/ZwT1zS/AyvsdvXZHrj15und67S12Y0rm3tbSs/uN4wkTYN5PjZ544iTf+ItiEJCALgaV2cOjAdhwoLx/BHRX/qFGAbDpt7TvtW972djLctrNRq89MKJ329FUC7lrjAC+bxXUlYHJYvS+Z9xu9MQjUnq3DaJHJKCLQSUtJpj4MH825JZz/UwPz0f3pCFTjJ8LHoGsN4zg/uFP4eMHjU04pt1szHv3VM+4+ijscyk9a2sA/3AYeYERwNPP63/pH3ESCehiUFFKMXt4NF/m9IM8ujv8Q43gPe1mKNpmzGff8TpsfwXixrr02ru576XWxk72ramUQscU4oihjg2RFxszVAZY6dmBTgK6GHRmj4jm7W1F5JTUkBHvQ8vyh0w2fs7/rUuv/Wcn9Npndt5rt9uM0rPZHxoDm8fzHNedCgt+acwRjxsr+XAfJgFdDDqzhxtLy7/KLfetgN7KP8SYBTPtJjiyHTa/aJT23f4qxI529NqvMaYMNlRB7qeOfPhqaKhwlJ49G+b80Cg9GzbE23ckPERWiopBR2vNWY+tYXxSGM/c2OGCO9/TVAtZbxq99sJMI2gPmWwMrtqbIDDKCN6tpWdlcw6fJStFhXChlGJOejSrdx3F3qIxmwZAisEaDFNvNH6Kdxq99oJNxqyU0RdB8gwwy3/uA538PywGpTnpMbyWWcAVT3/F366bQkpUkLeb5DkJE+Ci//V2K4QXSHUcMSi1zkffnl/B/P9dS12TzcstEuL0SUAXg1JcWNuuRfYWzQvr87zXGCE8RAK6GLR+d/l4hjpSLX9cnc0X+0u93CIhTo8EdDFoXT9zGOt+toAfnz8SgP98fdjLLRLi9MigqBj0fnBOOnlltazJLhk4s17EoCQ9dDHoKaU4e1Qsx+ua2VlY6e3mCNFjEtCFAOZmxKIUrM0u8XZT+tSOggqqGpq93QzhIW4FdKXUQqVUtlIqRym1tIPXf6yU2q2U2qGU+lQp1Y/L2AlxsqhgK5OSI/h8X/8aGD1a1dBr184pqWHJ39Zz7p8+77XPEH3rlAFdKWUGngIWAWOB65RSY084bSswXWs9EVgBPO7phgrR284eGcv2/AqO1zZ5uykAfLm/jJm//5RPdh/tleuX1TQCUFrdyL6j1b3yGaJvudNDnwHkaK0PaK2bgOXApa4naK3XaK3rHE+/BpI920whet/Zo2Jp0bCun0xf/HSvEchX7SrulevXNrYtpvr3hkO98hmib7kT0JOAfJfnBY5jnbkV+LCjF5RStyulMpVSmaWl/eM/GiFaTUqOID7Mn3e2FXm7KQBkOQZo1+0rpcnW4vHr1zgC+ozUKF7eeIivD5R7/DNE3/LooKhS6gZgOvDHjl7XWj+rtZ6utZ4eGxvryY8W4rSZTYorpibz2d4S1ueUebs5FB6vJyrYSkl1I5/u8Xzapa7JDsCjV04gyM/cb77IRM+5E9ALAdcNBJMdx9pRSp0H/AJYorVu9EzzhOhbF45LAOD6f26kuLL3BiRP5Z1thRRVNnDNGSlEBVtZmeX5tEtryiUm1J+5GbF8vPtor/wlIPqOOwF9E5ChlEpTSlmBa4F3XU9QSk0BnsEI5oNr3pcYUCYmhTsLd7219aR+S5/54fJtAKREBnHhuAQ+3XOUhmajR72rqJJl6w/2OPhW1DVx/+vbOXzMGPYKtlq45owUymoaWd1L+XrRN04Z0LXWNuAeYDWwB3hNa71LKfWwUmqJ47Q/AiHA60qpbUqpdzu5nBD9msmkePX2WUxKiWBV1hEAmmwt5JbWeKU9IQEWFk9IoK7JztpsY9zpyU/289B7u3l2XW6Prvl6ZgErNhfw0oZDBPiZMJsUZ4+MZWhUEC9tyPNc40WfcyuHrrVeqbUeqbUeobX+nePYg1rrdx2Pz9Nax2utJzt+lnR9RSH6twvHxbO9oJIjlfU898UBzv3T5+w5UtVnnx8T4g/A4vEJzBoeTWSQH//ddJijVQ0UVdYD8FpmAS0t3d9xbG9x2xTFEH+j+ofJpLhx1jA25R0/6T4fW7WXzLxjJ12nrKaRJz7KptFm73YbRO+QlaJCdKA1l/7RrqMUHDcC6Nvb+i4F02xv4abZw7CYTfiZTVw2JYk12aXM/P2nZBVWERpg4fCxOr4+6P7MlC/3l5GZd4zso20Bu7K+bZXo1dOT8beYeGnDIVZlHeF4bRONNjtPr83l9yv3nHS9P67K5i+f5fDOVhlM7S8koAvRgRGxIaTHhbB6VzFWs1Gs691tRdh70CPuibomG0H+bbXz7r9gFLfNTXM+//684YQGWHjxqzzc3Rf4hn9t5Kp/bKC4soE56cY4QbO97b0RQVYunTyEV785zB0vb+G3H+ymos4I+FsOVzinUbZqrXvTl190omsS0IXoxIXj4tl48BgHy43BwyOVDWw+dLzXP7fJ1kKzXRPkZ3YeC/a38IuLxnL/BSMZnxTGFVOTuXpaCqt3HeWVb7pX9respomZadE8e+M0nvr21HavfWd2qvPxR7uOsvVw2/3+Z2P7xUfHHCtqv8otJ/9YHcL7JKAL0YkLxyVgb9Gs21dKRlwIVouJVb0wffBE9Y754a499Fb3nJPB+z+Yy5CIQJYuGs2o+NBu9dJbJYQHcMG4BC6amNju+PikcN6660zeuutMAH7xVhYAaTHBvL21qF2Kpq7Jxvlj41EKXt9c0K3PF71DAroQnZiQFE5yZCAASZGBzE2PYVXWkR4NRHZHrWN/0yCrucvzrBYTN52Zyr6jNVz1jw1sPtR+4HJ7fgWLnvyC0urGk1JFYQF+nV53ytBIpgyN5NozUih39MLvmj+C+mY7b7gE7vpmO+lxIZyVHsMbm3s2QCs8SwK6EJ1Qylg5ClBc2cAlk4ZQVNnAY6v29urntq7gPFVAB7hkktHD3nzoOFc+vaHda+9tL2LPkSqeXptLTYPxJfHAotH8+ZrJnD82/pTXvmxKW4WPuRmxTBkawctfH6KlRbdLC109PYXCinq+ypXSAd4mAV2ILtw6xxiIvGhCIpdOHsLiCQk8s+4A//ryYK99Zp2jhx5sPfWGYqEBfkxKDnc+31nQNnAZEmC8/51thRRWGDN1ooKtXDYlya1dmcYNCXM+jgjy4+YzUzlQVstHu4vbpYUuGBtPWICF1zfnU1HXPypVDlYS0IXoQniQH/seWcQ956SjlOInF4wC4Om1OdjsvbNMvrbR/R46wIvfncGyW84g2GrmGZfFRq357or6Zm7/dyYAYYGdp1pOpJRi9X3z+OVFYwjwM3PRhESGRQfx/Po86prb0kIBfmYum5LEO9uKmPzwx/2upvxgIgFdiFOwWkwoZfRoR8SG8I8bplJW09RrKYb61mDZwaBoRyKCrMwfFceNs1P5YOcRckqMVa2V9c0kRQRy37kZzrn0XeXOOzIqIZTvzR0OgMVs4tozhvLNwWNkFRpz2Vu/dK6bMdT5nv983f9K8TbZWk6adjkQSUAXopvmj4ojNMDS6fzrwor6bs86cdXaQw92s4fe6ntz0wj0M/PzN3Zgb9FU1TcTHujHbfOGtw3uRgT2uF0AV05LwmJSvLDeSDkFOdJCYxLD+N3l4wm2mvlo91H2Fvfdqlp3vL+jiIv/+iX/7odfNp4kAV2IbgrwM7NofAKrs4ppaLazq6jS2fvLP1bHnEc/48+f7O/x9Vtz6IHdDOgxIf78Zsk4Nh86zgvrD/LJnhJC/C0E+JlZe/98vvmfcxkaHdTjdgHEhQZw7pg4518nrmmh62cO48275gBw+0ub+9Wsl1pHzv+xD/ee1pftqdhbdJ8tPuuIBHQheuCyyUnUNtn5ZM9RHnxnF9//txHASqqNkrtPfrqflzbkYbO3cOfLm7u1IKl1los7g6InunxKEkkRgTzygbFU/xtHDRaL2URcWEC3r9eR62e2bRl84pfOqIRQ/nDFBA4fq2NTB/VfvKX1y6Wm0UZmLy4Ou/ofX3H9P7/u1b1guyIBXYgemDk8mrhQf97eWsSh8joKK+r5Ju8YVQ1t27r95r3dbDlcwYdZxVz59FdorfnTR9nsKKgA4E8fZbM2++Rq085pi/7d66GDEbi/e1ZbiYArpna1uVjPzM2IcT4O9Du5jZdOHkKw1cwbW/rPYqNmlwHsV7u5stZdx2qb2HK4gq8PHOvVvWC7IgFdiB4wmxSXTh7CJ3uOOjdbfmtLIdWOgP7sjdOwt2ieWpPjfE/aAyv562c5LPnbegqO1/HXz3K4+YVN/PqdLN52qb1e22jDbFJYzT37z/PGWcM4d3QcD148lsevnHgad9kxpRTPfWc6Q6OCnLl5V0FWC0smD+HtrUUUHO8fJQGaHAH9yqnJrNx5pN2KV0/Z4uj5+1uM/9+eWpvTq+mdjkhAF6KHXFMPVouJlTuPUFptBPfJKRFMGxbZ6RS+Vza29RJf3HCI+/67jaoGI8jUNdkJspqdM2u6y2ox8a+bz+C7Z6Vh6eGXwqmcPzaedT9bQGgns2buOScDu9b9ZvPpZpsRWL8zexgNzS089O4utNY0NNt5fNVejtee/vz51i+Jj340j4cvHcfWwxVsyuv92j+uJKAL0UOpMcEsv30WAL+6eCzVjTbnBhGhAX5cNS3Zee4T35rEw5eOY3RCKAB/X5tLVLC13fUmPvQROSXV1DXZepQ/70+SIgI5f0w8z31xgK9yvb8/a5PdjtmkmJQSweiEUN7aWshne0vYkFvO39fmcsfLm9Fat+tRt7Rofv1Oltszdlo33Q7xt3D1tBQig/x48J0s57hKX5CALsRpmDU8moN/WMwNM4cyZWgEh8rrMCkI8DNx8cRE0uNCmDo0giumJvOd2amsum+es3RtemwIN84a1u565z2xjtcyC9xeVNSfPXbVRGJC/Hnk/T29kuLojma7xs9RBvmtu+YQ4m/h5a8PUVFv9Mw3HjxG2gMr+c7z3ziDekl1Iy9uOMQTH+1z6zOqHX9hhQRYCLSauWt+OnuLq7n8qa/6bOaLBHQhTpNSCqUUtzjKBLRo41hogB+f/Phs3rjzzHbn3zU/HTAGFx9aMo5PfjyPL362gMkpEc5zLOaepVv6k/BAPx68ZCy7j1Qx6TcfsavIewt7mmwtzjGJQKuZuxeksya7lNVZ7Qcuv9hf5qxe2ZoC+3RvCUccu0R1pbrRhtViwt9ifBnfMieV88bEU1hRz6/eySKrsLLXd3eSgC6Eh1w4ruOCVyfmwuekx7DrNxdy5/wRmE2K9LhQUqKCeMxlAHPfUe/sYeppF08cws1npgLw8Hu7+3yQsFWzvQWrpS3c3XTmMEL9LazaVYzVbGL7ry9gzf3zmZQczkPv7eaF9XnOvyrsLZr/bso/5WdUN9gIdVndazGbePbGaVw0MZFXNh7m4r9+ybee+bpXg7oEdCE8xN9i5tErJnD/BSNPeW6wv+WkActRCaEc+P1iAIZGnd4CoP7k15eM5deXjGXjwWNs8FJFxiZbC34u/95BVgvfnmWUK2iytxAe6EdaTDBv3HkmYxPDeH79QedAaXyYP09+up+vD3Td9poGG6EB7cc+TCbFLy8a41yhuz2/olcHiiWgC+FB184Yyj3nZPT4/SaTYuP/nOvcYGIgUEpx3YyhJIQF8MTH+7zSSz+xhw5wx7wRJ51nMZv4wTnpFByvd85Xf/SKiYQF+PH4KcomV9Y3OytcukoMD+TLny/g4B8WM21YJK9sPNxr/wYS0IXoZ+LDAogO8fd2MzwqwM/M3eekk3noOGc9toackuo+/XxjULR9uIsMtvL8zdN54ZYz2h2/YFwCYxPDWJNtTDmdlBLBvedmsOVwRaczdjLzjvH5vlL2HOn4vlrHWe5eMIKbzkzF1kuDpBLQhRB94prpKVw+JYmjVQ389v09ffrZjSekXFqdMzqeBaPi2h0zmxQ/WzjK+TwswMLV05OJCPLj+y9tptyxkMzVxoNGmYNR8aFdtuOc0fHcdGZqh23xBAnoQog+YbWY+L9rJvPjC0by+b7SPi1n22xvwdqNmUNnj4x1PraYTYQF+PHiLTOobrTxtzU5rNnbvmRDeY2Rb1/+/VmeaXAPSUAXQvSpG2YNIzTA0q4sQm/rKIfeFaUU7//gLJ741iTnsUkpEZw3Jp4X1udxy7JN7YqPFRyvY2R8SLfrzXuaBHQhRJ8KC/DjljNT+TCrmJU7j/TJZzbbO065dGV8UrhzT9lWP3GZwfSkS4nkguP1p11r3hMkoAsh+tztZ49gaFQQ97yyhQOlvTPn/qvcMhY/+QVf7i87adpiT41JDGPN/fO5/4KRfJlTRqajl360qoGEcAnoQohBKMTfwoo7ZuNnNvF/p7EZSEdapwR+tqeE3Ueq+PkbO6htsntsIDItJpjvnpVGdLCV376/m9pGG+W1TcSFen9mkgR0IYRXxIUFcMfZI3hvexGpSz/g0Q/3UlnXfForKZd/c5i0B1aSW1rDP780tskrrKgnp6TGWdbWE4KsFu5ekM72gkpu+NdGAOLCJKALIQaxO+e3Le75x+e5LHpyHTf+85t2G1J0R+umGuf+6XMARieEct4YoyTDTg/PqrllTio3n5nK1sPGhiVxoZ7ZEep0SEAXQnhNgJ+Zf9wwlRBHDZSiyga+yTvGox92vSqzMyknlEy4/4JRPHntZKDzWjs9pZTi/gvb5qvH9oOUi28XXRZC+LyF4xNZOD6RB97cwavf5DM3I4Z/fXmQReMTmJ4a1a1rVdU3MyYxjMXjE5g7MtZZwTL7kYU93gGqKyH+Fv57+yye++IAI+NDPH797pKALoToF5YuHMP0YVEsmpDAvMfX8P1/b+a9H5zFkG5MB6ysbyY80MIPzm1fT6e1pG1vmDk8mpnDo3vt+t0hKRchRL8QHuTHldOSCbJa+NdNZ1DV0MzP39jBxgPl5JS4N7XRCOjeXdzjTRLQhRD9zqSUCB68ZBwbcsu55tmvOe+Jz50bTnTEZm/hnD+tZd/RGgnoQgjR39w4axjv/eAspg2LBNqvzDxRVYONA6W1gFFZcbByK6ArpRYqpbKVUjlKqaUdvD5PKbVFKWVTSl3l+WYKIQajMYlhvHHnmVw3YyjLvspjV1Elz3ye69x8olVdk835OKMfDE56yykDulLKDDwFLALGAtcppcaecNph4GbgFU83UAghfnbhKEIDLNz0/Cb+8OFeHvmgffnduiZjMdJDl4zl9rnDvdHEfsGdHvoMIEdrfUBr3QQsBy51PUFrnae13gH0bDWAEEJ0ITLYyk8vHEWZoxb5G1sK2HL4uPP12kajhz4sOvikrf0GE3fuPAlw3SG1wHGs25RStyulMpVSmaWlpT25hBBikLr2jKFMSg5nVHwo8WH+PPhOFjbHitLWHnqQtfemJ/qCPv0q01o/q7WerrWeHhsbe+o3CCGEg9mk+Pf3ZvLKbTP59SXjyCqs4pl1BwDXgD64l9a4E9ALgRSX58mOY0II0afCAvyIDvFn8YRELpqYyJ8/2Ud2cbVzUDTIX3rop7IJyFBKpSmlrMC1wLu92ywhhOjaw0vGERbgx/2vb6eq3pijHiw99K5prW3APcBqYA/wmtZ6l1LqYaXUEgCl1BlKqQLgauAZpdSu3my0EEJEh/jzyGXj2VlY6Uy9DPYeultfZ1rrlcDKE4496PJ4E0YqRggh+syiCYlcPDGR93cYW9kF+Q3ugD545/cIIQaEhy8dT0yIFavZNKinLIJUWxRC+LioYCt/v34aW13mpQ9WEtCFED5vRloUM9K6Vzt9IBrcf58IIcQAIgFdCCEGCAnoQggxQEhAF0KIAUICuhBCDBAS0IUQYoCQgC6EEAOEBHQhhBgglNbe2VBVKVUKHOrm22KAsl5ojjfIvfRPci/910C6n9O5l2Fa6w43lPBaQO8JpVSm1nq6t9vhCXIv/ZPcS/81kO6nt+5FUi5CCDFASEAXQogBwtcC+rPeboAHyb30T3Iv/ddAup9euRefyqELIYTonK/10IUQQnRCAroQQgwQPhHQlVILlVLZSqkcpdRSb7fHHUqp55VSJUqpLJdjUUqpj5VS+x3/G+k4rpRSf3Hc3w6l1FTvtbw9pVSKUmqNUmq3UmqXUuqHjuM+dy8ASqkApdQ3Sqntjvv5jeN4mlJqo6Pd/1VKWR3H/R3Pcxyvp3qz/SdSSpmVUluVUu87nvvkfQAopfKUUjuVUtuUUpmOY776exahlFqhlNqrlNqjlJrdF/fS7wO6UsoMPAUsAsYC1ymlxnq3VW5ZBiw84dhS4FOtdQbwqeM5GPeW4fi5HXi6j9roDhvwE631WGAWcLfj398X7wWgEThHaz0JmAwsVErNAh4D/k9rnQ4cB251nH8rcNxx/P8c5/UnPwT2uDz31ftotUBrPdlljrav/p49CazSWo8GJmH8f9T796K17tc/wGxgtcvzB4AHvN0uN9ueCmS5PM8GEh2PE4Fsx+NngOs6Oq+//QDvAOcPkHsJArYAMzFW7VlO/J0DVgOzHY8tjvOUt9vuaE+yIzCcA7wPKF+8D5f7yQNiTjjmc79nQDhw8MR/3764l37fQweSgHyX5wWOY74oXmt9xPG4GIh3PPaJe3T8mT4F2IgP34sjTbENKAE+BnKBCq21zXGKa5ud9+N4vRKI7tsWd+rPwM+AFsfzaHzzPlpp4COl1Gal1O2OY774e5YGlAIvONJh/1RKBdMH9+ILAX1A0sZXsc/MGVVKhQBvAPdpratcX/O1e9Fa27XWkzF6uDOA0V5uUrcppS4GSrTWm73dFg86S2s9FSMFcbdSap7riz70e2YBpgJPa62nALW0pVeA3rsXXwjohUCKy/NkxzFfdFQplQjg+N8Sx/F+fY9KKT+MYP4frfWbjsM+eS+utNYVwBqM1ESEUsrieMm1zc77cbweDpT3cVM7MgdYopTKA5Zjh++RuQAAAXRJREFUpF2exPfuw0lrXej43xLgLYwvW1/8PSsACrTWGx3PV2AE+F6/F18I6JuADMfovRW4FnjXy23qqXeBmxyPb8LIR7ce/45jtHsWUOnyp5lXKaUU8C9gj9b6CZeXfO5eAJRSsUqpCMfjQIzxgD0Ygf0qx2kn3k/rfV4FfOboXXmV1voBrXWy1joV47+Jz7TW1+Nj99FKKRWslAptfQxcAGThg79nWutiIF8pNcpx6FxgN31xL94eQHBzkGExsA8j1/kLb7fHzTa/ChwBmjG+sW/FyFl+CuwHPgGiHOcqjJk8ucBOYLq32+9yH2dh/Gm4A9jm+Fnsi/fiaN9EYKvjfrKABx3HhwPfADnA64C/43iA43mO4/Xh3r6HDu5pPvC+L9+Ho93bHT+7Wv879+Hfs8lApuP37G0gsi/uRZb+CyHEAOELKRchhBBukIAuhBADhAR0IYQYICSgCyHEACEBXQghBggJ6EIIMUBIQBdCiAHi/wFoHBkWRLma7wAAAABJRU5ErkJggg==
"
>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">learn</span><span class="o">.</span><span class="n">show_results</span><span class="p">(</span><span class="n">hf_tokenizer</span><span class="o">=</span><span class="n">hf_tokenizer</span><span class="p">,</span> <span class="n">max_n</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea ">

</div>

</div>

<div class="output_area">


<div class="output_html rendered_html output_subarea ">
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>text</th>
      <th>category</th>
      <th>target</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>The trouble with the book, "Memoirs of a Geisha" is that it had Japanese surfaces but underneath the surfaces it was all an American man's way of thinking. Reading the book is like watching a magnificent ballet with great music, sets, and costumes yet performed by barnyard animals dressed in those costumesÂ—so far from Japanese ways of thinking were the characters.&lt;br /&gt;&lt;br /&gt;The movie isn't about Japan or real geisha. It is a story about a few American men's mistaken ideas about Japan and geisha filtered through their own ignorance and misconceptions. So what is this movie if it isn't about Japan or geisha? Is it pure fantasy as so many people have said? Yes, but then why make it into an American fantasy?&lt;br /&gt;&lt;br /&gt;There were so many missed opportunities. Imagine a culture where there are no puritanical hang-ups, no connotations of sin about sex. Sex is natural and normal. How is sex handled in this movie? Right. Like it was dirty. The closest thing to a sex scene in the movie has Sayuri wrinkling up her nose and grimacing with distaste for five seconds as if the man trying to mount her had dropped a handful of cockroaches on her crotch. &lt;br /&gt;&lt;br /&gt;Does anyone actually enjoy sex in this movie? Nope. One character is said to be promiscuous but all we see is her pushing away her lover because it looks like she doesn't want to get caught doing something dirty. Such typical American puritanism has no place in a movie about Japanese geisha.&lt;br /&gt;&lt;br /&gt;Did Sayuri enjoy her first ravishing by some old codger after her cherry was auctioned off? Nope. She lies there like a cold slab of meat on a chopping block. Of course she isn't supposed to enjoy it. And that is what I mean about this movie. Why couldn't they have given her something to enjoy? Why does all the sex have to be sinful and wrong?&lt;br /&gt;&lt;br /&gt;Behind Mameha the Chairman was Sayuri's secret patron, and as such he was behind the auction of her virginity. He could have rigged the auction and won her himself. Nobu didn't even bid. So why did the Chairman let that old codger win her and, reeking of old-man stink, get his fingers all over her naked body? Would any woman ever really forgive a man for that?&lt;br /&gt;&lt;br /&gt;Let's</td>
      <td>negative</td>
      <td>negative</td>
    </tr>
    <tr>
      <th>1</th>
      <td>How viewers react to this new "adaption" of Shirley Jackson's book, which was promoted as NOT being a remake of the original 1963 movie (true enough), will be based, I suspect, on the following: those who were big fans of either the book or original movie are not going to think much of this one...and those who have never been exposed to either, and who are big fans of Hollywood's current trend towards "special effects" being the first and last word in how "good" a film is, are going to love it.&lt;br /&gt;&lt;br /&gt;Things I did not like about this adaption:&lt;br /&gt;&lt;br /&gt;1. It was NOT a true adaption of the book. From the articles I had read, this movie was supposed to cover other aspects in the book that the first one never got around to. And, that seemed reasonable, no film can cover a book word for word unless it is the length of THE STAND! (And not even then) But, there were things in this movie that were never by any means ever mentioned or even hinted at, in the movie. Reminded me of the way they decided to kill off the black man in the original movie version of THE SHINING. I didn't like that, either. What the movie's press release SHOULD have said is..."We got the basic, very basic, idea from Shirley Jackson's book, we kept the same names of the house and several (though not all) of the leading character's names, but then we decided to write our own story, and, what the heck, we watched THE CHANGELING and THE SHINING and GHOST first, and decided to throw in a bit of them, too."&lt;br /&gt;&lt;br /&gt;2. They completely lost the theme of a parapyschologist inviting carefully picked guest who had all had brushes with the paranormal in their pasts, to investigate a house that truly seemed to have been "born bad". No, instead, this "doctor" got everyone to the house under the false pretense of studying their "insomnia" (he really invited them there to scare them to death and then see how they reacted to their fear...like lab rats, who he mentioned never got told they are part of an experiment...nice guy). This doctor, who did not have the same name, by the way, was as different from the dedicated professional of the original movie as night from day.&lt;br /&gt;&lt;br /&gt;3</td>
      <td>negative</td>
      <td>negative</td>
    </tr>
  </tbody>
</table>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">learn</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="s2">&quot;This was a really good movie, &quot;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea ">

</div>

</div>

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>(&#39;positive&#39;, tensor(1), tensor([0.1190, 0.8810]))</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">learn</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="s2">&quot;Acting was so bad it was almost funny.&quot;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea ">

</div>

</div>

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>(&#39;negative&#39;, tensor(0), tensor([0.9973, 0.0027]))</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>And what about inference?</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">learn</span><span class="o">.</span><span class="n">export</span><span class="p">(</span><span class="n">fname</span><span class="o">=</span><span class="s1">&#39;seq_class_learn_export.pkl&#39;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">inf_learn</span> <span class="o">=</span> <span class="n">load_learner</span><span class="p">(</span><span class="n">fname</span><span class="o">=</span><span class="s1">&#39;seq_class_learn_export.pkl&#39;</span><span class="p">)</span>
<span class="n">inf_learn</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="s2">&quot;This movie should not be seen by anyone!!!!&quot;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea ">

</div>

</div>

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>(&#39;negative&#39;, tensor(0), tensor([0.9588, 0.0412]))</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Question-Answer">Question Answer<a class="anchor-link" href="#Question-Answer"> </a></h3><p>Given a document (context) and a question, the objective of these models is to predict the start and end token of the correct answer as it exists in the context.</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h2 id="HF_QstAndAnsModelCallback" class="doc_header"><code>class</code> <code>HF_QstAndAnsModelCallback</code><a href="https://github.com/ohmeow/blurr/tree/master/blurr/modeling.py#L95" class="source_link" style="float:right">[source]</a></h2><blockquote><p><code>HF_QstAndAnsModelCallback</code>() :: <a href="/blurr/modeling#HF_BaseModelCallback"><code>HF_BaseModelCallback</code></a></p>
</blockquote>
<p>Basic class handling tweaks of the training loop by changing a <code>Learner</code> in various events</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h2 id="HF_QstAndAnsModelWrapper" class="doc_header"><code>class</code> <code>HF_QstAndAnsModelWrapper</code><a href="https://github.com/ohmeow/blurr/tree/master/blurr/modeling.py#L100" class="source_link" style="float:right">[source]</a></h2><blockquote><p><code>HF_QstAndAnsModelWrapper</code>(<strong><code>hf_model</code></strong>) :: <a href="/blurr/modeling#HF_BaseModelWrapper"><code>HF_BaseModelWrapper</code></a></p>
</blockquote>
<p>A custom model wrapper for question answer models since we need all the outputs (not just the first)</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>And here we provide a custom loss function our question answer task, expanding on some techniques learned from here and here.</p>
<p>In fact, this new loss function can be used in many other multi-modal architectures, with any mix of loss functions.  For example, this can be ammended to include the <code>is_impossible</code> task, as well as the start/end token tasks in the SQUAD v2 dataset.</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h2 id="MultiTargetLoss" class="doc_header"><code>class</code> <code>MultiTargetLoss</code><a href="https://github.com/ohmeow/blurr/tree/master/blurr/modeling.py#L112" class="source_link" style="float:right">[source]</a></h2><blockquote><p><code>MultiTargetLoss</code>(<strong><code>funcs</code></strong>=<em><code>[&lt;function cross_entropy at 0x7f51f8b49320&gt;, &lt;function cross_entropy at 0x7f51f8b49320&gt;]</code></em>, <strong><code>func_kwargs</code></strong>=<em><code>[{}, {}]</code></em>, <strong><code>weights</code></strong>=<em><code>[1, 1]</code></em>, <strong><code>activation_funcs</code></strong>=<em><code>[functools.partial(&lt;function softmax at 0x7f51f8b48710&gt;, dim=-1), functools.partial(&lt;function softmax at 0x7f51f8b48710&gt;, dim=-1)]</code></em>, <strong><code>decode_funcs</code></strong>=<em><code>[functools.partial(&lt;built-in method argmax of type object at 0x7f52324d6c40&gt;, dim=-1), functools.partial(&lt;built-in method argmax of type object at 0x7f52324d6c40&gt;, dim=-1)]</code></em>, <strong><code>reduction</code></strong>=<em><code>'mean'</code></em>) :: <code>Module</code></p>
</blockquote>
<p>Provides the ability to apply different loss functions to multi-modal targets/predictions</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Again, we'll use a subset of pre-processed SQUAD v2 for our purposes below.</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">path</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="s1">&#39;./&#39;</span><span class="p">)</span>
<span class="n">squad_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">path</span><span class="o">/</span><span class="s1">&#39;squad_sample.csv&#39;</span><span class="p">);</span> <span class="nb">len</span><span class="p">(</span><span class="n">squad_df</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>1000</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">squad_df</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>title</th>
      <th>context</th>
      <th>question_id</th>
      <th>question_text</th>
      <th>is_impossible</th>
      <th>answer_text</th>
      <th>answer_start</th>
      <th>answer_end</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>New_York_City</td>
      <td>The New York City Fire Department (FDNY), provides fire protection, technical rescue, primary response to biological, chemical, and radioactive hazards, and emergency medical services for the five boroughs of New York City. The New York City Fire Department is the largest municipal fire department in the United States and the second largest in the world after the Tokyo Fire Department. The FDNY employs approximately 11,080 uniformed firefighters and over 3,300 uniformed EMTs and paramedics. The FDNY's motto is New York's Bravest.</td>
      <td>56d1076317492d1400aab78c</td>
      <td>What does FDNY stand for?</td>
      <td>False</td>
      <td>New York City Fire Department</td>
      <td>4</td>
      <td>33</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Cyprus</td>
      <td>Following the death in 1473 of James II, the last Lusignan king, the Republic of Venice assumed control of the island, while the late king's Venetian widow, Queen Catherine Cornaro, reigned as figurehead. Venice formally annexed the Kingdom of Cyprus in 1489, following the abdication of Catherine. The Venetians fortified Nicosia by building the Venetian Walls, and used it as an important commercial hub. Throughout Venetian rule, the Ottoman Empire frequently raided Cyprus. In 1539 the Ottomans destroyed Limassol and so fearing the worst, the Venetians also fortified Famagusta and Kyrenia.</td>
      <td>572e7f8003f98919007566df</td>
      <td>In what year did the Ottomans destroy Limassol?</td>
      <td>False</td>
      <td>1539</td>
      <td>481</td>
      <td>485</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">pretrained_model_name</span> <span class="o">=</span> <span class="s1">&#39;bert-large-uncased-whole-word-masking-finetuned-squad&#39;</span>
<span class="n">hf_tokenizer_cls</span> <span class="o">=</span> <span class="n">BertTokenizer</span>
<span class="n">hf_model_cls</span> <span class="o">=</span> <span class="n">HF_MODELS</span><span class="o">.</span><span class="n">BertForQuestionAnswering</span>

<span class="n">hf_arch</span><span class="p">,</span> <span class="n">hf_tokenizer</span><span class="p">,</span> <span class="n">hf_config</span><span class="p">,</span> <span class="n">hf_model</span> <span class="o">=</span> <span class="n">BLURR_MODEL_HELPER</span><span class="o">.</span><span class="n">get_hf_objects</span><span class="p">(</span><span class="n">pretrained_model_name</span><span class="p">,</span>
                                                                               <span class="n">hf_tokenizer_cls</span><span class="p">,</span>
                                                                               <span class="n">hf_model_cls</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">pre_process_squad</span><span class="p">(</span><span class="n">row</span><span class="p">):</span>
    <span class="n">context</span><span class="p">,</span> <span class="n">qst</span><span class="p">,</span> <span class="n">ans</span> <span class="o">=</span> <span class="n">row</span><span class="p">[</span><span class="s1">&#39;context&#39;</span><span class="p">],</span> <span class="n">row</span><span class="p">[</span><span class="s1">&#39;question_text&#39;</span><span class="p">],</span> <span class="n">row</span><span class="p">[</span><span class="s1">&#39;answer_text&#39;</span><span class="p">]</span>
    
    <span class="n">tok_input</span> <span class="o">=</span> <span class="n">hf_tokenizer</span><span class="o">.</span><span class="n">convert_ids_to_tokens</span><span class="p">(</span><span class="n">hf_tokenizer</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="n">qst</span><span class="p">,</span> <span class="n">context</span><span class="p">))</span>
    <span class="n">tok_ans</span> <span class="o">=</span> <span class="n">hf_tokenizer</span><span class="o">.</span><span class="n">tokenize</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;answer_text&#39;</span><span class="p">]),</span> 
                                    <span class="n">add_special_tokens</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> 
                                    <span class="n">add_prefix_space</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
    
    <span class="n">start_idx</span><span class="p">,</span> <span class="n">end_idx</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span><span class="mi">0</span>
    <span class="k">for</span> <span class="n">idx</span><span class="p">,</span> <span class="n">tok</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">tok_input</span><span class="p">):</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="k">if</span> <span class="p">(</span><span class="n">tok</span> <span class="o">==</span> <span class="n">tok_ans</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="ow">and</span> <span class="n">tok_input</span><span class="p">[</span><span class="n">idx</span><span class="p">:</span><span class="n">idx</span> <span class="o">+</span> <span class="nb">len</span><span class="p">(</span><span class="n">tok_ans</span><span class="p">)]</span> <span class="o">==</span> <span class="n">tok_ans</span><span class="p">):</span> 
                <span class="n">start_idx</span><span class="p">,</span> <span class="n">end_idx</span> <span class="o">=</span> <span class="n">idx</span><span class="p">,</span> <span class="n">idx</span> <span class="o">+</span> <span class="nb">len</span><span class="p">(</span><span class="n">tok_ans</span><span class="p">)</span>
                <span class="k">break</span>
        <span class="k">except</span><span class="p">:</span> <span class="k">pass</span>
            
    <span class="n">row</span><span class="p">[</span><span class="s1">&#39;tokenized_input&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">tok_input</span>
    <span class="n">row</span><span class="p">[</span><span class="s1">&#39;tokenized_input_len&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">tok_input</span><span class="p">)</span>
    <span class="n">row</span><span class="p">[</span><span class="s1">&#39;tok_answer_start&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">start_idx</span>
    <span class="n">row</span><span class="p">[</span><span class="s1">&#39;tok_answer_end&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">end_idx</span>
    
    <span class="k">return</span> <span class="n">row</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">squad_df</span> <span class="o">=</span> <span class="n">squad_df</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">pre_process_squad</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stderr output_text">
<pre>Token indices sequence length is longer than the specified maximum sequence length for this model (16 &gt; 512). Running this sequence through the model will result in indexing errors
Token indices sequence length is longer than the specified maximum sequence length for this model (12 &gt; 512). Running this sequence through the model will result in indexing errors
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">max_seq_len</span><span class="o">=</span> <span class="mi">128</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">squad_df</span> <span class="o">=</span> <span class="n">squad_df</span><span class="p">[(</span><span class="n">squad_df</span><span class="o">.</span><span class="n">tokenized_input_len</span> <span class="o">&lt;</span> <span class="n">max_seq_len</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">squad_df</span><span class="o">.</span><span class="n">is_impossible</span> <span class="o">==</span> <span class="kc">False</span><span class="p">)]</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">vocab</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="n">max_seq_len</span><span class="p">))</span>
<span class="c1"># vocab = dict(enumerate(range(max_seq_len)));</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># (optional): override HF_BatchTransform defaults</span>
<span class="n">hf_batch_tfm</span> <span class="o">=</span> <span class="n">HF_BatchTransform</span><span class="p">(</span><span class="n">hf_arch</span><span class="p">,</span> <span class="n">hf_tokenizer</span><span class="p">,</span> <span class="n">task</span><span class="o">=</span><span class="n">ForQuestionAnsweringTask</span><span class="p">(),</span>
                                 <span class="n">max_seq_len</span><span class="o">=</span><span class="mi">128</span><span class="p">,</span> <span class="n">truncation_strategy</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>

<span class="n">blocks</span> <span class="o">=</span> <span class="p">(</span>
    <span class="n">HF_TextBlock</span><span class="o">.</span><span class="n">from_df</span><span class="p">(</span><span class="n">text_cols_lists</span><span class="o">=</span><span class="p">[[</span><span class="s1">&#39;question_text&#39;</span><span class="p">],[</span><span class="s1">&#39;context&#39;</span><span class="p">]],</span> 
                         <span class="n">hf_arch</span><span class="o">=</span><span class="n">hf_arch</span><span class="p">,</span> <span class="n">hf_tokenizer</span><span class="o">=</span><span class="n">hf_tokenizer</span><span class="p">,</span> <span class="n">hf_batch_tfm</span><span class="o">=</span><span class="n">hf_batch_tfm</span><span class="p">),</span>
    <span class="n">CategoryBlock</span><span class="p">(</span><span class="n">vocab</span><span class="o">=</span><span class="n">vocab</span><span class="p">),</span>
    <span class="n">CategoryBlock</span><span class="p">(</span><span class="n">vocab</span><span class="o">=</span><span class="n">vocab</span><span class="p">)</span>
<span class="p">)</span>

<span class="c1"># can&#39;t export lambda functions, so made the getter a standard method</span>
<span class="k">def</span> <span class="nf">get_x</span><span class="p">(</span><span class="n">x</span><span class="p">):</span> <span class="k">return</span> <span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">text0</span><span class="p">,</span> <span class="n">x</span><span class="o">.</span><span class="n">text1</span><span class="p">)</span>

<span class="n">dblock</span> <span class="o">=</span> <span class="n">DataBlock</span><span class="p">(</span><span class="n">blocks</span><span class="o">=</span><span class="n">blocks</span><span class="p">,</span> 
                   <span class="n">get_x</span><span class="o">=</span><span class="n">get_x</span><span class="p">,</span>
                   <span class="n">get_y</span><span class="o">=</span><span class="p">[</span><span class="n">ColReader</span><span class="p">(</span><span class="s1">&#39;tok_answer_start&#39;</span><span class="p">),</span> <span class="n">ColReader</span><span class="p">(</span><span class="s1">&#39;tok_answer_end&#39;</span><span class="p">)],</span>
                   <span class="n">splitter</span><span class="o">=</span><span class="n">RandomSplitter</span><span class="p">(),</span>
                   <span class="n">n_inp</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">dls</span> <span class="o">=</span> <span class="n">dblock</span><span class="o">.</span><span class="n">dataloaders</span><span class="p">(</span><span class="n">squad_df</span><span class="p">,</span> <span class="n">bs</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea ">

</div>

</div>

<div class="output_area">


<div class="output_html rendered_html output_subarea ">

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="nb">len</span><span class="p">(</span><span class="n">dls</span><span class="o">.</span><span class="n">vocab</span><span class="p">),</span> <span class="n">dls</span><span class="o">.</span><span class="n">vocab</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">dls</span><span class="o">.</span><span class="n">vocab</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>(3, (#128) [0,1,2,3,4,5,6,7,8,9...], (#128) [0,1,2,3,4,5,6,7,8,9...])</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">dls</span><span class="o">.</span><span class="n">show_batch</span><span class="p">(</span><span class="n">hf_tokenizer</span><span class="o">=</span><span class="n">hf_tokenizer</span><span class="p">,</span> <span class="n">max_n</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea ">
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>text</th>
      <th>category</th>
      <th>category_</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>the peace pagoda built in new delhi by the nipponzan myohoji was inaugurated by which prominent figure? in 2007, the japanese buddhist organisation nipponzan myohoji decided to build a peace pagoda in the city containing buddha relics. it was inaugurated by the current dalai lama.</td>
      <td>56</td>
      <td>58</td>
    </tr>
    <tr>
      <th>1</th>
      <td>how many different places were visited by the aircraft taking the torch team? internationally, the torch and its accompanying party traveled in a chartered air china airbus a330 ( registered b - 6075 ), painted in the red and yellow colors of the olympic games. air china was chosen by the beijing committees of the olympic game as the designated olympic torch carrier in march 2008 for its long - standing participation in the olympic cause. the plane traveled a total of 137, 000 km ( 85, 000 mi ) for a duration of 130 days through 21 countries and regions.</td>
      <td>109</td>
      <td>110</td>
    </tr>
  </tbody>
</table>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">model</span> <span class="o">=</span> <span class="n">HF_QstAndAnsModelWrapper</span><span class="p">(</span><span class="n">hf_model</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">learn</span> <span class="o">=</span> <span class="n">Learner</span><span class="p">(</span><span class="n">dls</span><span class="p">,</span> 
                <span class="n">hf_model</span><span class="p">,</span>
                <span class="n">opt_func</span><span class="o">=</span><span class="n">partial</span><span class="p">(</span><span class="n">Adam</span><span class="p">,</span> <span class="n">decouple_wd</span><span class="o">=</span><span class="kc">True</span><span class="p">),</span>
                <span class="n">cbs</span><span class="o">=</span><span class="p">[</span><span class="n">HF_QstAndAnsModelCallback</span><span class="p">],</span>
                <span class="n">splitter</span><span class="o">=</span><span class="n">hf_splitter</span><span class="p">)</span>

<span class="n">learn</span><span class="o">.</span><span class="n">loss_func</span><span class="o">=</span><span class="n">MultiTargetLoss</span><span class="p">()</span>
<span class="n">learn</span><span class="o">.</span><span class="n">create_opt</span><span class="p">()</span>             <span class="c1"># -&gt; will create your layer groups based on your &quot;splitter&quot; function</span>
<span class="n">learn</span><span class="o">.</span><span class="n">freeze</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Notice above how I had to define the loss function <em>after</em> creating the <code>Learner</code> object.  I'm not sure why, but the <a href="/blurr/modeling#MultiTargetLoss"><code>MultiTargetLoss</code></a> above prohibits the learner from being exported if I do.</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># learn.summary()</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">learn</span><span class="o">.</span><span class="n">opt</span><span class="o">.</span><span class="n">param_groups</span><span class="p">))</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>4
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>If we are using the callback, like we are here, we have to unpack the <code>HF_baseInput</code> (the <code>x</code> returned from <code>dls.one_batch()</code> list into a tuple (which is what <code>*x</code> will do) since the <code>learn.model</code> below is in this case a huggingface transformer model (not a wrapper).</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">x</span><span class="p">,</span> <span class="n">y_start</span><span class="p">,</span> <span class="n">y_end</span> <span class="o">=</span> <span class="n">dls</span><span class="o">.</span><span class="n">one_batch</span><span class="p">()</span>
<span class="n">preds</span> <span class="o">=</span> <span class="n">learn</span><span class="o">.</span><span class="n">model</span><span class="p">(</span><span class="o">*</span><span class="n">x</span><span class="p">)</span>
<span class="nb">len</span><span class="p">(</span><span class="n">preds</span><span class="p">),</span><span class="n">preds</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>(2, torch.Size([4, 128]))</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1">#slow</span>
<span class="n">learn</span><span class="o">.</span><span class="n">lr_find</span><span class="p">(</span><span class="n">suggestions</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea ">

</div>

</div>

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>SuggestedLRs(lr_min=0.05248074531555176, lr_steep=1.737800812406931e-05)</pre>
</div>

</div>

<div class="output_area">



<div class="output_png output_subarea ">
<img src="data:image/png;base64,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
"
>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1">#slow</span>
<span class="n">learn</span><span class="o">.</span><span class="n">fit_one_cycle</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="n">lr_max</span><span class="o">=</span><span class="mf">1e-3</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea ">
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: left;">
      <th>epoch</th>
      <th>train_loss</th>
      <th>valid_loss</th>
      <th>time</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>0</td>
      <td>4.607925</td>
      <td>2.503709</td>
      <td>00:05</td>
    </tr>
    <tr>
      <td>1</td>
      <td>3.053877</td>
      <td>1.904655</td>
      <td>00:05</td>
    </tr>
    <tr>
      <td>2</td>
      <td>2.406597</td>
      <td>1.838473</td>
      <td>00:05</td>
    </tr>
  </tbody>
</table>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">learn</span><span class="o">.</span><span class="n">show_results</span><span class="p">(</span><span class="n">hf_tokenizer</span><span class="o">=</span><span class="n">hf_tokenizer</span><span class="p">,</span> <span class="n">skip_special_tokens</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">max_n</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea ">

</div>

</div>

<div class="output_area">


<div class="output_html rendered_html output_subarea ">
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>text</th>
      <th>category</th>
      <th>category_</th>
      <th>target1</th>
      <th>target2</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>how much does the program cost? another initiative, presented by the late mayor thomas menino, is the renew boston whole building incentive, which reduces the cost of living in buildings that are deemed energy efficient. this, much like the green housing developments, gives people of low socioeconomic status an opportunity to find housing in communities that support the environment. the ultimate goal of this initiative is to enlist 500 bostonians to participate in a free, in - home energy assessment.</td>
      <td>87</td>
      <td>88</td>
      <td>87</td>
      <td>94</td>
    </tr>
    <tr>
      <th>1</th>
      <td>when did the royal naval engineering college shut its doors in plymouth? the city was also home to the royal naval engineering college ; opened in 1880 in keyham, it trained engineering students for five years before they completed the remaining two years of the course at greenwich. the college closed in 1910, but in 1940 a new college opened at manadon. this was renamed dockyard technical college in 1959 before finally closing in 1994 ; training was transferred to the university of southampton.</td>
      <td>58</td>
      <td>59</td>
      <td>58</td>
      <td>59</td>
    </tr>
  </tbody>
</table>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">inf_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="o">.</span><span class="n">from_dict</span><span class="p">([{</span>
    <span class="s1">&#39;text1&#39;</span><span class="p">:</span> <span class="s1">&#39;George Lucas created Star Wars in 1977. He directed and produced it.&#39;</span><span class="p">,</span> 
    <span class="s1">&#39;text0&#39;</span><span class="p">:</span> <span class="s1">&#39;What did George Lucas make?&#39;</span>
<span class="p">}],</span> 
    <span class="n">orient</span><span class="o">=</span><span class="s1">&#39;columns&#39;</span><span class="p">)</span>

<span class="n">learn</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">inf_df</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea ">

</div>

</div>

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>((&#39;11&#39;, &#39;12&#39;),
 tensor([11]),
 tensor([[8.7752e-06, 7.4557e-06, 8.9024e-07, 2.4284e-06, 9.6714e-07, 1.4940e-06,
          1.2440e-07, 8.7754e-06, 1.1502e-03, 6.7750e-05, 1.9329e-03, 9.9598e-01,
          9.8235e-05, 1.6892e-05, 5.0291e-05, 8.8590e-06, 4.3379e-04, 1.4414e-04,
          3.0875e-06, 5.2095e-05, 7.0278e-06, 8.7739e-06, 8.8091e-06, 7.4837e-08,
          8.1184e-08, 7.7924e-08, 7.8391e-08, 7.8590e-08, 8.1421e-08, 8.2224e-08,
          7.7212e-08, 8.0432e-08, 8.0040e-08, 7.9221e-08, 7.3858e-08, 7.2623e-08,
          7.5648e-08, 7.5986e-08, 7.2546e-08, 7.2985e-08, 7.4694e-08, 7.7348e-08,
          7.8749e-08, 7.6069e-08, 8.0228e-08, 7.9536e-08, 8.0326e-08, 7.9156e-08,
          8.0157e-08, 8.0782e-08, 8.2086e-08, 8.1910e-08, 8.0596e-08, 8.2615e-08,
          8.5299e-08, 8.5622e-08, 8.5128e-08, 8.3114e-08, 8.4529e-08, 8.6528e-08,
          8.5513e-08, 8.2144e-08, 8.0740e-08, 8.3161e-08, 8.6860e-08, 8.3490e-08,
          8.1321e-08, 8.3735e-08, 8.3799e-08, 8.5124e-08, 8.3334e-08, 8.3645e-08,
          8.4133e-08, 8.7254e-08, 8.5445e-08, 8.5767e-08, 8.6912e-08, 8.7310e-08,
          8.7199e-08, 8.5267e-08, 8.5975e-08, 8.8442e-08, 9.0614e-08, 9.1963e-08,
          8.7421e-08, 8.6836e-08, 8.8150e-08, 9.2549e-08, 8.9596e-08, 8.3649e-08,
          7.9696e-08, 8.4731e-08, 8.1614e-08, 7.1216e-08, 7.8397e-08, 7.4655e-08,
          7.7314e-08, 7.2126e-08, 6.6236e-08, 6.9343e-08, 6.7258e-08, 6.2946e-08,
          6.0198e-08, 6.3826e-08, 6.7619e-08, 7.3795e-08, 7.0478e-08, 6.7092e-08,
          6.8017e-08, 6.8951e-08, 7.6672e-08, 7.2622e-08, 7.3270e-08, 7.5395e-08,
          7.9132e-08, 7.9281e-08, 7.2715e-08, 6.9317e-08, 6.7698e-08, 6.9000e-08,
          6.3288e-08, 5.9552e-08, 6.8661e-08, 6.7026e-08, 6.8790e-08, 6.7652e-08,
          6.2692e-08, 6.5552e-08]]))</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Note that there is a bug currently in fastai v2 (or with how I'm assembling everything) that currently prevents us from seeing the decoded predictions and probabilities for the "end" token.</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">inf_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="o">.</span><span class="n">from_dict</span><span class="p">([{</span>
    <span class="s1">&#39;text1&#39;</span><span class="p">:</span> <span class="s1">&#39;George Lucas created Star Wars in 1977. He directed and produced it.&#39;</span><span class="p">,</span> 
    <span class="s1">&#39;text0&#39;</span><span class="p">:</span> <span class="s1">&#39;When was Star Wars made?&#39;</span>
<span class="p">}],</span> 
    <span class="n">orient</span><span class="o">=</span><span class="s1">&#39;columns&#39;</span><span class="p">)</span>

<span class="n">test_dl</span> <span class="o">=</span> <span class="n">dls</span><span class="o">.</span><span class="n">test_dl</span><span class="p">(</span><span class="n">inf_df</span><span class="p">)</span>
<span class="n">inp</span><span class="p">,</span> <span class="n">probs</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">preds</span> <span class="o">=</span> <span class="n">learn</span><span class="o">.</span><span class="n">get_preds</span><span class="p">(</span><span class="n">dl</span><span class="o">=</span><span class="n">test_dl</span><span class="p">,</span> <span class="n">with_input</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">with_decoded</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea ">

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">hf_tokenizer</span><span class="o">.</span><span class="n">convert_ids_to_tokens</span><span class="p">(</span><span class="n">inp</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">tolist</span><span class="p">()[</span><span class="mi">0</span><span class="p">],</span> 
                                   <span class="n">skip_special_tokens</span><span class="o">=</span><span class="kc">False</span><span class="p">)[</span><span class="n">torch</span><span class="o">.</span><span class="n">argmax</span><span class="p">(</span><span class="n">probs</span><span class="p">[</span><span class="mi">0</span><span class="p">]):</span><span class="n">torch</span><span class="o">.</span><span class="n">argmax</span><span class="p">(</span><span class="n">probs</span><span class="p">[</span><span class="mi">1</span><span class="p">])]</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>[&#39;1977&#39;]</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">learn</span><span class="o">.</span><span class="n">unfreeze</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1">#slow</span>
<span class="n">learn</span><span class="o">.</span><span class="n">fit_one_cycle</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="n">lr_max</span><span class="o">=</span><span class="nb">slice</span><span class="p">(</span><span class="mf">1e-7</span><span class="p">,</span> <span class="mf">1e-4</span><span class="p">))</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea ">
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: left;">
      <th>epoch</th>
      <th>train_loss</th>
      <th>valid_loss</th>
      <th>time</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>0</td>
      <td>1.942993</td>
      <td>1.635881</td>
      <td>00:14</td>
    </tr>
    <tr>
      <td>1</td>
      <td>1.776195</td>
      <td>1.489648</td>
      <td>00:14</td>
    </tr>
    <tr>
      <td>2</td>
      <td>1.535312</td>
      <td>1.465136</td>
      <td>00:14</td>
    </tr>
  </tbody>
</table>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">learn</span><span class="o">.</span><span class="n">recorder</span><span class="o">.</span><span class="n">plot_loss</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_png output_subarea ">
<img src="data:image/png;base64,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
"
>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">learn</span><span class="o">.</span><span class="n">show_results</span><span class="p">(</span><span class="n">hf_tokenizer</span><span class="o">=</span><span class="n">hf_tokenizer</span><span class="p">,</span> <span class="n">max_n</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea ">

</div>

</div>

<div class="output_area">


<div class="output_html rendered_html output_subarea ">
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>text</th>
      <th>category</th>
      <th>category_</th>
      <th>target1</th>
      <th>target2</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>how much does the program cost? another initiative, presented by the late mayor thomas menino, is the renew boston whole building incentive, which reduces the cost of living in buildings that are deemed energy efficient. this, much like the green housing developments, gives people of low socioeconomic status an opportunity to find housing in communities that support the environment. the ultimate goal of this initiative is to enlist 500 bostonians to participate in a free, in - home energy assessment.</td>
      <td>87</td>
      <td>88</td>
      <td>87</td>
      <td>88</td>
    </tr>
    <tr>
      <th>1</th>
      <td>what is worn by usaf members to indicate a billet assignment? in addition to basic uniform clothing, various badges are used by the usaf to indicate a billet assignment or qualification - level for a given assignment. badges can also be used as merit - based or service - based awards. over time, various badges have been discontinued and are no longer distributed. authorized badges include the shields of usaf fire protection, and security forces, and the missile badge ( or " pocket rocket " ), which is earned after working in a missile system maintenance or missile operations capacity for at least one year.</td>
      <td>22</td>
      <td>24</td>
      <td>22</td>
      <td>24</td>
    </tr>
  </tbody>
</table>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">learn</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">inf_df</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea ">

</div>

</div>

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>((&#39;14&#39;, &#39;15&#39;),
 tensor([14]),
 tensor([[3.6733e-05, 2.4402e-05, 4.2569e-06, 3.1660e-06, 1.8432e-06, 8.3012e-06,
          1.1498e-06, 3.6735e-05, 1.6130e-04, 2.5064e-05, 1.1958e-04, 3.1135e-04,
          9.2668e-06, 8.1608e-03, 9.9096e-01, 8.1820e-06, 7.2405e-06, 5.3144e-06,
          1.2716e-06, 4.0502e-06, 4.0634e-06, 3.6727e-05, 3.6761e-05, 2.8476e-07,
          3.1073e-07, 2.9824e-07, 3.0127e-07, 2.9457e-07, 3.0058e-07, 2.9218e-07,
          2.9060e-07, 2.9113e-07, 3.0392e-07, 3.0314e-07, 2.8819e-07, 2.9018e-07,
          2.9128e-07, 2.8990e-07, 2.8550e-07, 2.8458e-07, 2.8048e-07, 2.8357e-07,
          2.9135e-07, 2.8929e-07, 2.9242e-07, 2.9338e-07, 2.8985e-07, 2.9206e-07,
          2.9356e-07, 2.9460e-07, 3.0917e-07, 3.0143e-07, 2.9868e-07, 3.0313e-07,
          3.0498e-07, 3.1143e-07, 3.0953e-07, 3.0525e-07, 3.0376e-07, 3.2255e-07,
          3.2182e-07, 3.0933e-07, 3.0898e-07, 3.0935e-07, 3.1578e-07, 3.0885e-07,
          3.0565e-07, 3.0689e-07, 3.0566e-07, 3.2711e-07, 3.0954e-07, 3.1065e-07,
          3.1206e-07, 3.2360e-07, 3.1884e-07, 3.2423e-07, 3.2154e-07, 3.2461e-07,
          3.3708e-07, 3.2581e-07, 3.3075e-07, 3.2655e-07, 3.3747e-07, 3.3734e-07,
          3.2938e-07, 3.2494e-07, 3.2958e-07, 3.4210e-07, 3.3460e-07, 3.1650e-07,
          3.0886e-07, 3.2145e-07, 3.1167e-07, 3.0167e-07, 3.0034e-07, 2.9413e-07,
          3.1020e-07, 2.9649e-07, 2.7851e-07, 2.8072e-07, 2.8126e-07, 2.7801e-07,
          2.7274e-07, 2.7454e-07, 2.8027e-07, 3.1420e-07, 3.0143e-07, 2.7974e-07,
          2.8347e-07, 2.9067e-07, 2.9691e-07, 2.9054e-07, 2.8761e-07, 2.8609e-07,
          3.1121e-07, 3.1030e-07, 2.9380e-07, 2.8688e-07, 2.8357e-07, 2.8667e-07,
          2.8377e-07, 2.7728e-07, 2.8606e-07, 2.7656e-07, 2.7735e-07, 2.8624e-07,
          2.7527e-07, 2.8140e-07]]))</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">preds</span><span class="p">,</span> <span class="n">pred_classes</span><span class="p">,</span> <span class="n">probs</span> <span class="o">=</span> <span class="n">learn</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">inf_df</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
<span class="n">preds</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea ">

</div>

</div>

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>(&#39;14&#39;, &#39;15&#39;)</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>And what about inference?</p>
<p>Note that I had to replace the loss function because of the above-mentioned issue to exporting the model with the <a href="/blurr/modeling#MultiTargetLoss"><code>MultiTargetLoss</code></a> loss function.  After getting our inference learner, we put it back and we're good to go!</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">learn</span><span class="o">.</span><span class="n">loss_func</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">CrossEntropyLoss</span><span class="p">()</span>
<span class="n">learn</span><span class="o">.</span><span class="n">export</span><span class="p">(</span><span class="n">fname</span><span class="o">=</span><span class="s1">&#39;q_and_a_learn_export.pkl&#39;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">inf_learn</span> <span class="o">=</span> <span class="n">load_learner</span><span class="p">(</span><span class="n">fname</span><span class="o">=</span><span class="s1">&#39;q_and_a_learn_export.pkl&#39;</span><span class="p">)</span>
<span class="n">inf_learn</span><span class="o">.</span><span class="n">loss_func</span> <span class="o">=</span> <span class="n">MultiTargetLoss</span><span class="p">()</span>

<span class="n">inf_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="o">.</span><span class="n">from_dict</span><span class="p">([</span>
    <span class="p">{</span><span class="s1">&#39;text0&#39;</span><span class="p">:</span> <span class="s1">&#39;George Lucas created Star Wars in 1977. He directed and produced it.&#39;</span><span class="p">,</span> 
     <span class="s1">&#39;text1&#39;</span><span class="p">:</span> <span class="s1">&#39;Who created Star Wars?&#39;</span><span class="p">}],</span>
    <span class="n">orient</span><span class="o">=</span><span class="s1">&#39;columns&#39;</span><span class="p">)</span>

<span class="n">inf_learn</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">inf_df</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea ">

</div>

</div>

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>((&#39;1&#39;, &#39;3&#39;),
 tensor([1]),
 tensor([[7.4321e-05, 9.9807e-01, 6.7940e-04, 3.5709e-05, 6.2262e-04, 4.3292e-06,
          1.6804e-05, 1.3794e-04, 2.6243e-06, 6.9573e-05, 1.8885e-05, 3.1564e-06,
          1.1348e-05, 3.6340e-06, 1.1163e-06, 7.4329e-05, 2.2135e-05, 7.1047e-06,
          1.3022e-05, 2.0289e-06, 1.6908e-06, 7.4160e-05, 6.3337e-07, 6.7324e-07,
          6.6458e-07, 5.5242e-07, 5.5449e-07, 5.3533e-07, 5.1626e-07, 5.2919e-07,
          5.1277e-07, 5.1399e-07, 5.2465e-07, 5.1575e-07, 5.2038e-07, 5.2790e-07,
          5.3009e-07, 5.3498e-07, 5.8855e-07, 5.6399e-07, 5.6691e-07, 5.6376e-07,
          5.2983e-07, 5.4369e-07, 5.3015e-07, 5.1924e-07, 5.3170e-07, 5.9284e-07,
          5.5275e-07, 5.2370e-07, 5.2029e-07, 5.1726e-07, 5.3282e-07, 5.0866e-07,
          4.6924e-07, 4.5960e-07, 4.7982e-07, 4.7741e-07, 4.7888e-07, 4.8595e-07,
          4.8810e-07, 5.1073e-07, 4.9360e-07, 5.0726e-07, 4.9225e-07, 5.0917e-07,
          5.0228e-07, 5.0220e-07, 5.1964e-07, 5.1000e-07, 6.5865e-07, 5.2866e-07,
          3.5230e-07, 4.3689e-07, 4.5912e-07, 4.5427e-07, 4.5702e-07, 4.8316e-07,
          4.6305e-07, 4.5693e-07, 4.3487e-07, 3.2427e-07, 3.0942e-07, 3.9004e-07,
          3.8219e-07, 4.3892e-07, 4.5425e-07, 4.6781e-07, 4.7521e-07, 5.0158e-07,
          4.7958e-07, 5.0350e-07, 5.0722e-07, 5.0666e-07, 5.1573e-07, 5.8558e-07,
          6.1360e-07, 5.5667e-07, 5.5609e-07, 5.5874e-07, 5.5489e-07, 5.5562e-07,
          6.4888e-07, 5.6833e-07, 5.5585e-07, 5.8460e-07, 5.5745e-07, 5.5387e-07,
          5.5998e-07, 5.4973e-07, 5.2996e-07, 5.7483e-07, 5.3834e-07, 5.1537e-07,
          5.2727e-07, 5.1860e-07, 5.2036e-07, 5.4843e-07, 5.2746e-07, 5.3079e-07,
          5.1899e-07, 5.4651e-07, 5.3479e-07, 5.7650e-07, 5.8250e-07, 5.9577e-07,
          5.4149e-07, 5.5723e-07]]))</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Token-classification">Token classification<a class="anchor-link" href="#Token-classification"> </a></h3><p>The objective of token classification is to predict the correct label for each token provided in the input. In the computer vision world, this is akin to what we do in segmentation tasks whereby we attempt to predict the class/label for each pixel in an image. Named entity recognition (NER) is an example of token classification in the NLP space</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># germ_eval_df = pd.read_csv(&#39;./data/task-token-classification/germeval2014ner/germeval2014ner_cleaned.csv&#39;)</span>
<span class="n">germ_eval_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;./germeval2014_sample.csv&#39;</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">germ_eval_df</span><span class="p">))</span>
<span class="n">germ_eval_df</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>1000
</pre>
</div>
</div>

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>pos</th>
      <th>token</th>
      <th>tag1</th>
      <th>tag2</th>
      <th>ds_type</th>
      <th>seq_id</th>
      <th>n_tokens</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1</td>
      <td>Schartau</td>
      <td>B-PER</td>
      <td>O</td>
      <td>train</td>
      <td>1</td>
      <td>3</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2</td>
      <td>sagte</td>
      <td>O</td>
      <td>O</td>
      <td>train</td>
      <td>1</td>
      <td>1</td>
    </tr>
    <tr>
      <th>2</th>
      <td>3</td>
      <td>dem</td>
      <td>O</td>
      <td>O</td>
      <td>train</td>
      <td>1</td>
      <td>1</td>
    </tr>
    <tr>
      <th>3</th>
      <td>4</td>
      <td>"</td>
      <td>O</td>
      <td>O</td>
      <td>train</td>
      <td>1</td>
      <td>1</td>
    </tr>
    <tr>
      <th>4</th>
      <td>5</td>
      <td>Tagesspiegel</td>
      <td>B-ORG</td>
      <td>O</td>
      <td>train</td>
      <td>1</td>
      <td>3</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>We are only going to be working with small sample from the <a href="https://sites.google.com/site/germeval2014ner/data">GermEval 2014</a> data set ... so the results might not be all that great :)</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">germ_eval_df</span><span class="o">.</span><span class="n">dropna</span><span class="p">(</span><span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">germ_eval_df</span><span class="p">[</span><span class="n">germ_eval_df</span><span class="o">.</span><span class="n">token</span><span class="o">.</span><span class="n">isna</span><span class="p">()]</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>pos</th>
      <th>token</th>
      <th>tag1</th>
      <th>tag2</th>
      <th>ds_type</th>
      <th>seq_id</th>
      <th>n_tokens</th>
    </tr>
  </thead>
  <tbody>
  </tbody>
</table>
</div>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">labels</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">germ_eval_df</span><span class="o">.</span><span class="n">tag1</span><span class="o">.</span><span class="n">unique</span><span class="p">())</span>
<span class="nb">print</span><span class="p">(</span><span class="n">labels</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>[&#39;B-LOC&#39;, &#39;B-LOCderiv&#39;, &#39;B-LOCpart&#39;, &#39;B-ORG&#39;, &#39;B-ORGpart&#39;, &#39;B-OTH&#39;, &#39;B-PER&#39;, &#39;B-PERpart&#39;, &#39;I-LOC&#39;, &#39;I-LOCderiv&#39;, &#39;I-ORG&#39;, &#39;I-ORGpart&#39;, &#39;I-OTH&#39;, &#39;I-PER&#39;, &#39;O&#39;]
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">germ_eval_df</span> <span class="o">=</span> <span class="n">germ_eval_df</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="n">by</span><span class="o">=</span><span class="s1">&#39;seq_id&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">agg</span><span class="p">(</span><span class="nb">list</span><span class="p">)</span><span class="o">.</span><span class="n">reset_index</span><span class="p">()</span>
<span class="n">germ_eval_df</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>seq_id</th>
      <th>pos</th>
      <th>token</th>
      <th>tag1</th>
      <th>tag2</th>
      <th>ds_type</th>
      <th>n_tokens</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1</td>
      <td>[1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25]</td>
      <td>[Schartau, sagte, dem, ", Tagesspiegel, ", vom, Freitag, ,, Fischer, sei, ", in, einer, Weise, aufgetreten, ,, die, alles, andere, als, Ã¼berzeugend, war, ", .]</td>
      <td>[B-PER, O, O, O, B-ORG, O, O, O, O, B-PER, O, O, O, O, O, O, O, O, O, O, O, O, O, O, O]</td>
      <td>[O, O, O, O, O, O, O, O, O, O, O, O, O, O, O, O, O, O, O, O, O, O, O, O, O]</td>
      <td>[train, train, train, train, train, train, train, train, train, train, train, train, train, train, train, train, train, train, train, train, train, train, train, train, train]</td>
      <td>[3, 1, 1, 1, 3, 1, 1, 2, 1, 1, 1, 1, 1, 1, 1, 2, 1, 1, 1, 1, 1, 3, 1, 1, 1]</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2</td>
      <td>[1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22]</td>
      <td>[FirmengrÃ¼nder, Wolf, Peter, Bree, arbeitete, Anfang, der, siebziger, Jahre, als, MÃ¶belvertreter, ,, als, er, einen, fliegenden, HÃ¤ndler, aus, dem, Libanon, traf, .]</td>
      <td>[O, B-PER, I-PER, I-PER, O, O, O, O, O, O, O, O, O, O, O, O, O, O, O, B-LOC, O, O]</td>
      <td>[O, O, O, O, O, O, O, O, O, O, O, O, O, O, O, O, O, O, O, O, O, O]</td>
      <td>[train, train, train, train, train, train, train, train, train, train, train, train, train, train, train, train, train, train, train, train, train, train]</td>
      <td>[3, 1, 1, 2, 1, 1, 1, 3, 1, 1, 4, 1, 1, 1, 1, 3, 2, 1, 1, 1, 1, 1]</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>After getting rid of troublesom NaNs and getting my labels, the code above converts my input datafame into something I can model by making the token and tag1 columns represent a list of tokens (or labels) for a give sequence.</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">task</span> <span class="o">=</span> <span class="n">HF_TASKS_AUTO</span><span class="o">.</span><span class="n">ForTokenClassification</span>
<span class="n">pretrained_model_name</span> <span class="o">=</span> <span class="s2">&quot;bert-base-multilingual-cased&quot;</span>

<span class="n">config</span> <span class="o">=</span> <span class="n">AutoConfig</span><span class="o">.</span><span class="n">from_pretrained</span><span class="p">(</span><span class="n">pretrained_model_name</span><span class="p">)</span>

<span class="n">config</span><span class="o">.</span><span class="n">num_labels</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">labels</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Notice above how I set the <code>config.num_labels</code> attribute to the number of labels we want <em>our</em> model to be able to predict. The model will update its last layer accordingly (this concept is essentially transfer learning).</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">hf_arch</span><span class="p">,</span> <span class="n">hf_tokenizer</span><span class="p">,</span> <span class="n">hf_config</span><span class="p">,</span> <span class="n">hf_model</span> <span class="o">=</span> <span class="n">BLURR_MODEL_HELPER</span><span class="o">.</span><span class="n">get_auto_hf_objects</span><span class="p">(</span><span class="n">pretrained_model_name</span><span class="p">,</span> 
                                                                                    <span class="n">task</span><span class="o">=</span><span class="n">task</span><span class="p">,</span> 
                                                                                    <span class="n">config</span><span class="o">=</span><span class="n">config</span><span class="p">)</span>
<span class="n">hf_arch</span><span class="p">,</span> <span class="nb">type</span><span class="p">(</span><span class="n">hf_tokenizer</span><span class="p">),</span> <span class="nb">type</span><span class="p">(</span><span class="n">hf_config</span><span class="p">),</span> <span class="nb">type</span><span class="p">(</span><span class="n">hf_model</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>(&#39;bert&#39;,
 transformers.tokenization_bert.BertTokenizer,
 transformers.configuration_bert.BertConfig,
 transformers.modeling_bert.BertForTokenClassification)</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">test_eq</span><span class="p">(</span><span class="n">hf_config</span><span class="o">.</span><span class="n">num_labels</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">labels</span><span class="p">))</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># single input</span>
<span class="n">blocks</span> <span class="o">=</span> <span class="p">(</span>
    <span class="n">HF_TextBlock</span><span class="o">.</span><span class="n">from_df</span><span class="p">(</span><span class="n">text_cols_lists</span><span class="o">=</span><span class="p">[[</span><span class="s1">&#39;token&#39;</span><span class="p">]],</span> 
                         <span class="n">hf_arch</span><span class="o">=</span><span class="n">hf_arch</span><span class="p">,</span> 
                         <span class="n">hf_tokenizer</span><span class="o">=</span><span class="n">hf_tokenizer</span><span class="p">,</span> 
                         <span class="n">tok_func_mode</span><span class="o">=</span><span class="s1">&#39;list&#39;</span><span class="p">,</span> 
                         <span class="n">task</span><span class="o">=</span><span class="n">ForTokenClassificationTask</span><span class="p">(),</span> <span class="n">max_seq_len</span><span class="o">=</span><span class="mi">128</span><span class="p">),</span>
    <span class="n">HF_TokenCategoryBlock</span><span class="p">(</span><span class="n">vocab</span><span class="o">=</span><span class="n">labels</span><span class="p">)</span>
<span class="p">)</span>

<span class="k">def</span> <span class="nf">get_y</span><span class="p">(</span><span class="n">inp</span><span class="p">):</span>
    <span class="k">return</span> <span class="p">[</span> <span class="p">(</span><span class="n">label</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">hf_tokenizer</span><span class="o">.</span><span class="n">tokenize</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">entity</span><span class="p">))))</span> <span class="k">for</span> <span class="n">entity</span><span class="p">,</span> <span class="n">label</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">inp</span><span class="o">.</span><span class="n">token</span><span class="p">,</span> <span class="n">inp</span><span class="o">.</span><span class="n">tag1</span><span class="p">)</span> <span class="p">]</span>

<span class="n">dblock</span> <span class="o">=</span> <span class="n">DataBlock</span><span class="p">(</span><span class="n">blocks</span><span class="o">=</span><span class="n">blocks</span><span class="p">,</span> 
                   <span class="n">get_x</span><span class="o">=</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="o">.</span><span class="n">text0</span><span class="p">,</span>
                   <span class="n">get_y</span><span class="o">=</span><span class="n">get_y</span><span class="p">,</span>
                   <span class="n">splitter</span><span class="o">=</span><span class="n">RandomSplitter</span><span class="p">())</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>We have to define a <code>get_y</code> that creates the same number of labels as there are subtokens for a particular token. For example, my name "Wayde" gets split up into two subtokens, "Way" and "##de". The label for "Wayde" is "B-PER" and we just repeat it for the subtokens.  This all get cleaned up when we show results and get predictions.</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">dls</span> <span class="o">=</span> <span class="n">dblock</span><span class="o">.</span><span class="n">dataloaders</span><span class="p">(</span><span class="n">germ_eval_df</span><span class="p">,</span> <span class="n">bs</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea ">

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">dls</span><span class="o">.</span><span class="n">show_batch</span><span class="p">(</span><span class="n">hf_tokenizer</span><span class="o">=</span><span class="n">hf_tokenizer</span><span class="p">,</span> <span class="n">max_n</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea ">
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>text</th>
      <th>category</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Das SS - Freiwilligen - Grenadier - Regiment 88 wurde im MÃ¤rz aus einer Kampfgruppe der SS - FÃ¼hrerschule des Wirtschafts - und Verwaltungsdienstes und Teilen des I. / SS - Polizei - Regiments 34 der Ordnungspolizei, HeeresangehÃ¶rigen und Volkssturm gebildet.</td>
      <td>['O', 'B-ORGpart', 'I-ORGpart', 'O', 'O', 'O', 'O', 'O', 'O', 'O', 'B-ORGpart', 'O', 'O', 'O', 'O', 'O', 'O', 'O', 'B-ORGpart', 'I-ORGpart', 'O', 'O', 'O', 'O', 'O', 'O', 'O', 'O']</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Scenes of a Sexual Nature ( GB 2006 ) - Regie : Ed Blum Shortbus ( USA 2006 ) - Regie : John Cameron Mitchell : Film Ã¼ber den gleichnamigen New Yorker Club, der verschiedensten Paaren eine Plattform zur Aufarbeitung ihrer Probleme bietet.</td>
      <td>['B-OTH', 'I-OTH', 'I-OTH', 'I-OTH', 'I-OTH', 'O', 'O', 'O', 'O', 'O', 'O', 'O', 'B-PER', 'I-PER', 'B-OTH', 'O', 'B-LOC', 'O', 'O', 'O', 'O', 'O', 'B-PER', 'I-PER', 'I-PER', 'O', 'O', 'O', 'O', 'B-LOCderiv', 'I-LOCderiv', 'O', 'O', 'O', 'O', 'O', 'O', 'O', 'O', 'O', 'O', 'O', 'O', 'O']</td>
    </tr>
  </tbody>
</table>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">learn</span> <span class="o">=</span> <span class="n">Learner</span><span class="p">(</span><span class="n">dls</span><span class="p">,</span> 
                <span class="n">hf_model</span><span class="p">,</span>
                <span class="n">opt_func</span><span class="o">=</span><span class="n">partial</span><span class="p">(</span><span class="n">Adam</span><span class="p">,</span> <span class="n">decouple_wd</span><span class="o">=</span><span class="kc">True</span><span class="p">),</span>
                <span class="n">metrics</span><span class="o">=</span><span class="p">[</span><span class="n">accuracy</span><span class="p">],</span>
                <span class="n">cbs</span><span class="o">=</span><span class="p">[</span><span class="n">HF_BaseModelCallback</span><span class="p">],</span>
                <span class="n">splitter</span><span class="o">=</span><span class="n">hf_splitter</span><span class="p">)</span>


<span class="n">learn</span><span class="o">.</span><span class="n">create_opt</span><span class="p">()</span>             <span class="c1"># -&gt; will create your layer groups based on your &quot;splitter&quot; function</span>
<span class="n">learn</span><span class="o">.</span><span class="n">freeze</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># learn.summary()</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">b</span> <span class="o">=</span> <span class="n">dls</span><span class="o">.</span><span class="n">one_batch</span><span class="p">()</span>
<span class="n">preds</span> <span class="o">=</span> <span class="n">learn</span><span class="o">.</span><span class="n">model</span><span class="p">(</span><span class="o">*</span><span class="n">b</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
<span class="nb">len</span><span class="p">(</span><span class="n">preds</span><span class="p">),</span><span class="n">preds</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>(1, torch.Size([4, 128, 15]))</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="nb">len</span><span class="p">(</span><span class="n">b</span><span class="p">),</span> <span class="nb">len</span><span class="p">(</span><span class="n">b</span><span class="p">[</span><span class="mi">0</span><span class="p">]),</span> <span class="n">b</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">b</span><span class="p">[</span><span class="mi">1</span><span class="p">]),</span> <span class="n">b</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>(2, 3, torch.Size([4, 128]), 4, torch.Size([4, 128]))</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">preds</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">view</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">preds</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="n">b</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">view</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="n">test_eq</span><span class="p">(</span><span class="n">preds</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">view</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">preds</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">b</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">view</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>torch.Size([512, 15]) torch.Size([512])
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">learn</span><span class="o">.</span><span class="n">opt</span><span class="o">.</span><span class="n">param_groups</span><span class="p">))</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>4
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1">#slow</span>
<span class="n">learn</span><span class="o">.</span><span class="n">unfreeze</span><span class="p">()</span>
<span class="n">learn</span><span class="o">.</span><span class="n">lr_find</span><span class="p">(</span><span class="n">suggestions</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea ">

</div>

</div>

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>SuggestedLRs(lr_min=0.0033113110810518267, lr_steep=1.737800812406931e-05)</pre>
</div>

</div>

<div class="output_area">



<div class="output_png output_subarea ">
<img src="data:image/png;base64,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
"
>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1">#slow</span>
<span class="n">learn</span><span class="o">.</span><span class="n">fit_one_cycle</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="n">lr_max</span><span class="o">=</span> <span class="mf">3e-5</span><span class="p">,</span> <span class="n">moms</span><span class="o">=</span><span class="p">(</span><span class="mf">0.8</span><span class="p">,</span><span class="mf">0.7</span><span class="p">,</span><span class="mf">0.8</span><span class="p">))</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea ">
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: left;">
      <th>epoch</th>
      <th>train_loss</th>
      <th>valid_loss</th>
      <th>accuracy</th>
      <th>time</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>0</td>
      <td>1.821035</td>
      <td>0.613166</td>
      <td>0.145313</td>
      <td>00:02</td>
    </tr>
    <tr>
      <td>1</td>
      <td>1.105999</td>
      <td>0.582503</td>
      <td>0.145313</td>
      <td>00:01</td>
    </tr>
    <tr>
      <td>2</td>
      <td>0.867438</td>
      <td>0.560528</td>
      <td>0.145313</td>
      <td>00:02</td>
    </tr>
  </tbody>
</table>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">learn</span><span class="o">.</span><span class="n">show_results</span><span class="p">(</span><span class="n">hf_tokenizer</span><span class="o">=</span><span class="n">hf_tokenizer</span><span class="p">,</span> <span class="n">max_n</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea ">

</div>

</div>

<div class="output_area">


<div class="output_html rendered_html output_subarea ">
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>text</th>
      <th>category</th>
      <th>target</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Viele Fragen der Schiffstheorie, die Euler schon aufgeworfen und mit den Mitteln seiner Zeit behandelt hatte, fanden in dieser Phase mit Hilfe moderner Erkenntnisse und Methoden eine abschlieÃŸende, physikalisch gesicherte Antwort.</td>
      <td>['O', 'O', 'O', 'O', 'O', 'O', 'B-PER', 'O', 'O', 'O', 'O', 'O', 'O', 'O', 'O', 'O', 'O', 'O', 'O', 'O', 'O', 'O', 'O', 'O', 'O', 'O', 'O', 'O', 'O', 'O', 'O', 'O', 'O', 'O', 'O']</td>
      <td>[O, O, O, O, O, O, O, O, O, O, O, O, O, O, O, O, O, O, O, O, O, O, O, O, O, O, O, O, O, O, O, O, O, O, O]</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Gerade nach dem ersten aufsehenerregenden 100 - Meter - Lauf bei den Olympischen Spielen in Peking 2008 spekulierten viele Ã¼ber nicht nachweisbare Mittel, die die ErmÃ¼dung der Muskulatur herauszÃ¶gern.</td>
      <td>['O', 'O', 'O', 'O', 'O', 'O', 'O', 'O', 'B-ORG', 'I-ORG', 'O', 'B-LOC', 'O', 'O', 'O', 'O', 'O', 'O', 'O', 'O', 'O', 'O', 'O', 'O', 'O', 'O', 'O']</td>
      <td>[O, O, O, O, O, O, O, O, O, O, O, O, O, O, O, O, O, O, O, O, O, O, O, O, O, O, O]</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Die Deutsche Flugsicherung ( DFS ) beschloss ein Flugverbot fÃ¼r alle internationalen FlughÃ¤fen mit Ausnahme der beiden Berliner FlughÃ¤fen bis 2. 00 Uhr nachts.</td>
      <td>['O', 'B-ORG', 'I-ORG', 'O', 'B-ORG', 'O', 'O', 'O', 'O', 'O', 'O', 'O', 'O', 'O', 'O', 'O', 'O', 'B-LOCderiv', 'O', 'O', 'O', 'O', 'O', 'O']</td>
      <td>[O, O, O, O, O, O, O, O, O, O, O, O, O, O, O, O, O, O, O, O, O, O, O, O]</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Im Herbst 1945 erfolgte seine Berufung an die UniversitÃ¤t Jena zum ordentlichen Professor auf den Lehrstuhl fÃ¼r Acker - und Pflanzenbau und die Ernennung zum Direktor des Instituts fÃ¼r Pflanzenbau und Pflanzenzucht.</td>
      <td>['O', 'O', 'O', 'O', 'O', 'O', 'O', 'O', 'B-ORG', 'I-ORG', 'O', 'O', 'O', 'O', 'O', 'O', 'O', 'O', 'O', 'O', 'O', 'O', 'O', 'O', 'O', 'O', 'B-ORG', 'I-ORG', 'I-ORG', 'I-ORG', 'I-ORG', 'O']</td>
      <td>[O, O, O, O, O, O, O, O, O, O, O, O, O, O, O, O, O, O, O, O, O, O, O, O, O, O, O, O, O, O, O, O]</td>
    </tr>
  </tbody>
</table>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">res</span> <span class="o">=</span> <span class="n">learn</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="s1">&#39;My name is Wayde and I live in San Diego&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">res</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea ">

</div>

</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>[&#39;O&#39;, &#39;O&#39;, &#39;O&#39;, &#39;O&#39;, &#39;O&#39;, &#39;O&#39;, &#39;O&#39;, &#39;O&#39;, &#39;O&#39;, &#39;O&#39;, &#39;O&#39;, &#39;O&#39;, &#39;O&#39;, &#39;O&#39;, &#39;O&#39;, &#39;O&#39;, &#39;O&#39;, &#39;O&#39;, &#39;O&#39;, &#39;O&#39;, &#39;O&#39;, &#39;O&#39;, &#39;O&#39;, &#39;O&#39;, &#39;O&#39;, &#39;O&#39;, &#39;O&#39;, &#39;O&#39;, &#39;O&#39;, &#39;O&#39;, &#39;O&#39;, &#39;O&#39;, &#39;O&#39;, &#39;O&#39;, &#39;O&#39;, &#39;O&#39;, &#39;O&#39;, &#39;O&#39;, &#39;O&#39;, &#39;O&#39;, &#39;O&#39;, &#39;O&#39;, &#39;O&#39;, &#39;O&#39;, &#39;O&#39;, &#39;O&#39;, &#39;O&#39;, &#39;O&#39;, &#39;O&#39;, &#39;O&#39;, &#39;O&#39;, &#39;O&#39;, &#39;O&#39;, &#39;O&#39;, &#39;O&#39;, &#39;O&#39;, &#39;O&#39;, &#39;O&#39;, &#39;O&#39;, &#39;O&#39;, &#39;O&#39;, &#39;O&#39;, &#39;O&#39;, &#39;O&#39;, &#39;O&#39;, &#39;O&#39;, &#39;O&#39;, &#39;O&#39;, &#39;O&#39;, &#39;O&#39;, &#39;O&#39;, &#39;O&#39;, &#39;O&#39;, &#39;O&#39;, &#39;O&#39;, &#39;O&#39;, &#39;O&#39;, &#39;O&#39;, &#39;O&#39;, &#39;O&#39;, &#39;O&#39;, &#39;O&#39;, &#39;O&#39;, &#39;O&#39;, &#39;O&#39;, &#39;O&#39;, &#39;O&#39;, &#39;O&#39;, &#39;O&#39;, &#39;O&#39;, &#39;O&#39;, &#39;O&#39;, &#39;O&#39;, &#39;O&#39;, &#39;O&#39;, &#39;O&#39;, &#39;O&#39;, &#39;O&#39;, &#39;O&#39;, &#39;O&#39;, &#39;O&#39;, &#39;O&#39;, &#39;O&#39;, &#39;O&#39;, &#39;O&#39;, &#39;O&#39;, &#39;O&#39;, &#39;O&#39;, &#39;O&#39;, &#39;O&#39;, &#39;O&#39;, &#39;O&#39;, &#39;O&#39;, &#39;O&#39;, &#39;O&#39;, &#39;O&#39;, &#39;O&#39;, &#39;O&#39;, &#39;O&#39;, &#39;O&#39;, &#39;O&#39;, &#39;O&#39;, &#39;O&#39;, &#39;O&#39;, &#39;O&#39;, &#39;O&#39;, &#39;O&#39;, &#39;O&#39;]
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>The default <code>Learner.predict</code> method returns a prediction per subtoken, including the special tokens for each architecture's tokenizer.</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="Learner.predict_tokens" class="doc_header"><code>Learner.predict_tokens</code><a href="https://github.com/ohmeow/blurr/tree/master/blurr/modeling.py#L163" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>Learner.predict_tokens</code>(<strong><code>inp</code></strong>, <strong>**<code>kargs</code></strong>)</p>
</blockquote>
<p>Remove all the unnecessary predicted tokens after calling <code>Learner.predict</code>, so that you only
get the predicted labels, label ids, and probabilities for what you passed into it in addition to the input</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">txt</span> <span class="o">=</span><span class="s2">&quot;Hi! My name is Wayde Gilliam from ohmeow.com.&quot;</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">res</span> <span class="o">=</span> <span class="n">learn</span><span class="o">.</span><span class="n">predict_tokens</span><span class="p">(</span><span class="n">txt</span><span class="p">)</span>
<span class="nb">print</span><span class="p">([(</span><span class="n">tok</span><span class="p">,</span> <span class="n">lbl</span><span class="p">)</span> <span class="k">for</span> <span class="n">tok</span><span class="p">,</span><span class="n">lbl</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">res</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">res</span><span class="p">[</span><span class="mi">1</span><span class="p">])])</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea ">

</div>

</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>[(&#39;Hi!&#39;, &#39;O&#39;), (&#39;My&#39;, &#39;O&#39;), (&#39;name&#39;, &#39;O&#39;), (&#39;is&#39;, &#39;O&#39;), (&#39;Wayde&#39;, &#39;O&#39;), (&#39;Gilliam&#39;, &#39;O&#39;), (&#39;from&#39;, &#39;O&#39;), (&#39;ohmeow.com.&#39;, &#39;O&#39;)]
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>It's interesting (and very cool) how well this model performs on English even thought it was trained against a German corpus.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Cleanup">Cleanup<a class="anchor-link" href="#Cleanup"> </a></h2>
</div>
</div>
</div>
</div>
 

