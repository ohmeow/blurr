---

title: modeling.seq2seq.summarization


keywords: fastai
sidebar: home_sidebar

summary: "This module contains custom models, custom splitters, etc... summarization tasks."
description: "This module contains custom models, custom splitters, etc... summarization tasks."
nb_path: "nbs/11_modeling-seq2seq-summarization.ipynb"
---
<!--

#################################################
### THIS FILE WAS AUTOGENERATED! DO NOT EDIT! ###
#################################################
# file to edit: nbs/11_modeling-seq2seq-summarization.ipynb
# command to build the docs after a change: nbdev_build_docs

-->

<div class="container" id="notebook-container">
        
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span> 
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>What we&#39;re running with at the time this documentation was generated:
torch: 1.10.1+cu111
fastai: 2.5.3
transformers: 4.16.2
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">torch</span><span class="o">.</span><span class="n">cuda</span><span class="o">.</span><span class="n">set_device</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Using GPU #</span><span class="si">{</span><span class="n">torch</span><span class="o">.</span><span class="n">cuda</span><span class="o">.</span><span class="n">current_device</span><span class="p">()</span><span class="si">}</span><span class="s2">: </span><span class="si">{</span><span class="n">torch</span><span class="o">.</span><span class="n">cuda</span><span class="o">.</span><span class="n">get_device_name</span><span class="p">()</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>Using GPU #1: GeForce GTX 1080 Ti
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Mid-level-API">Mid-level API<a class="anchor-link" href="#Mid-level-API"> </a></h2>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Example">Example<a class="anchor-link" href="#Example"> </a></h3><p>The objective of summarization is to generate a concise and accurate representation of a much larger body of text.  For example, we may want to summarize an article in a single sentence.</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">dataset</span> <span class="o">=</span> <span class="n">load_dataset</span><span class="p">(</span><span class="s2">&quot;cnn_dailymail&quot;</span><span class="p">,</span> <span class="s2">&quot;3.0.0&quot;</span><span class="p">,</span> <span class="n">split</span><span class="o">=</span><span class="s2">&quot;train[:1000]&quot;</span><span class="p">)</span>
<span class="n">cnndm_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">dataset</span><span class="p">)</span>
<span class="n">cnndm_df</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stderr output_text">
<pre>Reusing dataset cnn_dailymail (/home/wgilliam/.cache/huggingface/datasets/cnn_dailymail/3.0.0/3.0.0/3cb851bf7cf5826e45d49db2863f627cba583cbc32342df7349dfe6c38060234)
</pre>
</div>
</div>

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>article</th>
      <th>highlights</th>
      <th>id</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>It's official: U.S. President Barack Obama wants lawmakers to weigh in on whether to use military force in Syria. Obama sent a letter to the heads of the House and Senate on Saturday night, hours after announcing that he believes military action against Syrian targets is the right step to take over the alleged use of chemical weapons. The proposed legislation from Obama asks Congress to approve the use of military force "to deter, disrupt, prevent and degrade the potential for future uses of chemical weapons or other weapons of mass destruction." It's a step that is set to turn an internat...</td>
      <td>Syrian official: Obama climbed to the top of the tree, "doesn't know how to get down"\nObama sends a letter to the heads of the House and Senate .\nObama to seek congressional approval on military action against Syria .\nAim is to determine whether CW were used, not by whom, says U.N. spokesman .</td>
      <td>0001d1afc246a7964130f43ae940af6bc6c57f01</td>
    </tr>
    <tr>
      <th>1</th>
      <td>(CNN) -- Usain Bolt rounded off the world championships Sunday by claiming his third gold in Moscow as he anchored Jamaica to victory in the men's 4x100m relay. The fastest man in the world charged clear of United States rival Justin Gatlin as the Jamaican quartet of Nesta Carter, Kemar Bailey-Cole, Nickel Ashmeade and Bolt won in 37.36 seconds. The U.S finished second in 37.56 seconds with Canada taking the bronze after Britain were disqualified for a faulty handover. The 26-year-old Bolt has now collected eight gold medals at world championships, equaling the record held by American trio...</td>
      <td>Usain Bolt wins third gold of world championship .\nAnchors Jamaica to 4x100m relay victory .\nEighth gold at the championships for Bolt .\nJamaica double up in women's 4x100m relay .</td>
      <td>0002095e55fcbd3a2f366d9bf92a95433dc305ef</td>
    </tr>
  </tbody>
</table>
</div></div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">pretrained_model_name</span> <span class="o">=</span> <span class="s2">&quot;sshleifer/distilbart-cnn-6-6&quot;</span>
<span class="n">hf_arch</span><span class="p">,</span> <span class="n">hf_config</span><span class="p">,</span> <span class="n">hf_tokenizer</span><span class="p">,</span> <span class="n">hf_model</span> <span class="o">=</span> <span class="n">BLURR</span><span class="o">.</span><span class="n">get_hf_objects</span><span class="p">(</span><span class="n">pretrained_model_name</span><span class="p">,</span> <span class="n">model_cls</span><span class="o">=</span><span class="n">BartForConditionalGeneration</span><span class="p">)</span>

<span class="n">hf_arch</span><span class="p">,</span> <span class="nb">type</span><span class="p">(</span><span class="n">hf_config</span><span class="p">),</span> <span class="nb">type</span><span class="p">(</span><span class="n">hf_tokenizer</span><span class="p">),</span> <span class="nb">type</span><span class="p">(</span><span class="n">hf_model</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>(&#39;bart&#39;,
 transformers.models.bart.configuration_bart.BartConfig,
 transformers.models.bart.tokenization_bart_fast.BartTokenizerFast,
 transformers.models.bart.modeling_bart.BartForConditionalGeneration)</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">text_gen_kwargs</span> <span class="o">=</span> <span class="p">{}</span>
<span class="k">if</span> <span class="n">hf_arch</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;bart&quot;</span><span class="p">,</span> <span class="s2">&quot;t5&quot;</span><span class="p">]:</span>
    <span class="n">text_gen_kwargs</span> <span class="o">=</span> <span class="p">{</span><span class="o">**</span><span class="n">hf_config</span><span class="o">.</span><span class="n">task_specific_params</span><span class="p">[</span><span class="s2">&quot;summarization&quot;</span><span class="p">],</span> <span class="o">**</span><span class="p">{</span><span class="s2">&quot;max_length&quot;</span><span class="p">:</span> <span class="mi">30</span><span class="p">,</span> <span class="s2">&quot;min_length&quot;</span><span class="p">:</span> <span class="mi">10</span><span class="p">}}</span>

<span class="c1"># not all &quot;summarization&quot; parameters are for the model.generate method ... remove them here</span>
<span class="n">generate_func_args</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">inspect</span><span class="o">.</span><span class="n">signature</span><span class="p">(</span><span class="n">hf_model</span><span class="o">.</span><span class="n">generate</span><span class="p">)</span><span class="o">.</span><span class="n">parameters</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>
<span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">text_gen_kwargs</span><span class="o">.</span><span class="n">copy</span><span class="p">():</span>
    <span class="k">if</span> <span class="n">k</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">generate_func_args</span><span class="p">:</span>
        <span class="k">del</span> <span class="n">text_gen_kwargs</span><span class="p">[</span><span class="n">k</span><span class="p">]</span>

<span class="k">if</span> <span class="n">hf_arch</span> <span class="o">==</span> <span class="s2">&quot;mbart&quot;</span><span class="p">:</span>
    <span class="n">text_gen_kwargs</span><span class="p">[</span><span class="s2">&quot;decoder_start_token_id&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">hf_tokenizer</span><span class="o">.</span><span class="n">get_vocab</span><span class="p">()[</span><span class="s2">&quot;en_XX&quot;</span><span class="p">]</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">tok_kwargs</span> <span class="o">=</span> <span class="p">{}</span>
<span class="k">if</span> <span class="n">hf_arch</span> <span class="o">==</span> <span class="s2">&quot;mbart&quot;</span><span class="p">:</span>
    <span class="n">tok_kwargs</span><span class="p">[</span><span class="s2">&quot;src_lang&quot;</span><span class="p">],</span> <span class="n">tok_kwargs</span><span class="p">[</span><span class="s2">&quot;tgt_lang&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;en_XX&quot;</span><span class="p">,</span> <span class="s2">&quot;en_XX&quot;</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">batch_tokenize_tfm</span> <span class="o">=</span> <span class="n">Seq2SeqBatchTokenizeTransform</span><span class="p">(</span>
    <span class="n">hf_arch</span><span class="p">,</span>
    <span class="n">hf_config</span><span class="p">,</span>
    <span class="n">hf_tokenizer</span><span class="p">,</span>
    <span class="n">hf_model</span><span class="p">,</span>
    <span class="n">max_length</span><span class="o">=</span><span class="mi">256</span><span class="p">,</span>
    <span class="n">max_target_length</span><span class="o">=</span><span class="mi">130</span><span class="p">,</span>
    <span class="n">tok_kwargs</span><span class="o">=</span><span class="n">tok_kwargs</span><span class="p">,</span>
    <span class="n">text_gen_kwargs</span><span class="o">=</span><span class="n">text_gen_kwargs</span><span class="p">,</span>
<span class="p">)</span>

<span class="n">blocks</span> <span class="o">=</span> <span class="p">(</span><span class="n">Seq2SeqTextBlock</span><span class="p">(</span><span class="n">batch_tokenize_tfm</span><span class="o">=</span><span class="n">batch_tokenize_tfm</span><span class="p">),</span> <span class="n">noop</span><span class="p">)</span>

<span class="n">dblock</span> <span class="o">=</span> <span class="n">DataBlock</span><span class="p">(</span><span class="n">blocks</span><span class="o">=</span><span class="n">blocks</span><span class="p">,</span> <span class="n">get_x</span><span class="o">=</span><span class="n">ColReader</span><span class="p">(</span><span class="s2">&quot;article&quot;</span><span class="p">),</span> <span class="n">get_y</span><span class="o">=</span><span class="n">ColReader</span><span class="p">(</span><span class="s2">&quot;highlights&quot;</span><span class="p">),</span> <span class="n">splitter</span><span class="o">=</span><span class="n">RandomSplitter</span><span class="p">())</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">dls</span> <span class="o">=</span> <span class="n">dblock</span><span class="o">.</span><span class="n">dataloaders</span><span class="p">(</span><span class="n">cnndm_df</span><span class="p">,</span> <span class="n">bs</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">b</span> <span class="o">=</span> <span class="n">dls</span><span class="o">.</span><span class="n">one_batch</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="nb">len</span><span class="p">(</span><span class="n">b</span><span class="p">),</span> <span class="n">b</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="s2">&quot;input_ids&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="n">b</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>(2, torch.Size([2, 256]), torch.Size([2, 67]))</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">dls</span><span class="o">.</span><span class="n">show_batch</span><span class="p">(</span><span class="n">dataloaders</span><span class="o">=</span><span class="n">dls</span><span class="p">,</span> <span class="n">max_n</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea "><table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>text</th>
      <th>target</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>&lt;s&gt; (CNN) -- When Ji Yeqing awakened, she was already in the recovery room. Chinese authorities had dragged her out of her home and down four flights of stairs, she said, restraining and beating her husband as he tried to come to her aid. They whisked her into a clinic, held her down on a bed and forced her to undergo an abortion. Her offense? Becoming pregnant with a second child, in violation of China's one-child policy. "After the abortion, I felt empty, as if something was scooped out of me," Ji told a congressional panel in September. "My husband and I had been so excited for our new baby. Now suddenly all that hope and joy and excitement disappeared.... I was very depressed and despondent. For a long time, whenever I thought about my lost child, I would cry." As she lay unconscious, she said, an IUD to prevent future pregnancies was inserted. The issue of forced abortions -- and in some cases, forced sterilizations -- in China has seized the spotlight in recent days with news of escaped activist Chen Guangcheng. Chen, a blind, self-taught lawyer, rose to fame in the late 1990s because of his advocacy for what he calls victims&lt;/s&gt;</td>
      <td>China's one-child policy results in forced abortions and sterilizations, activists say.\nWomen tell of emotional and physical consequences from the procedures.\nActivist Chen Guangcheng works to advocate for victims of such practices.</td>
    </tr>
    <tr>
      <th>1</th>
      <td>&lt;s&gt; (CNN) -- Sitting incongruously among the hangars and laboratories of NASA's Ames Research Center in Silicon Valley is the squat facade of an old McDonald's. You won't get a burger there, though -- its cash registers and soft-serve machines have given way to old tape drives and modern computers run by a rogue team of hacker engineers who've rechristened the place McMoon's. These self-described techno-archaeologists have been on a mission to recover and digitize forgotten photos taken in the '60s by a quintet of scuttled lunar satellites. The Lunar Orbiter Image Recovery Project (LOIRP) has since 2007 brought some 2,000 pictures back from 1,500 analog data tapes. They contain the first high-resolution photographs ever taken from behind the lunar horizon, including the first photo of an earthrise (first slide above). Thanks to the technical savvy and DIY engineering of the team at LOIRP, it's being seen at a higher resolution than was ever previously possible. "We're reaching back to a capability that existed but couldn't be touched back when it was created," says Keith Cowing, co-lead and founding member at LOIRP. "It's like having a DVD in&lt;/s&gt;</td>
      <td>NASA-funded project has recovered 2,000 analog moon pictures.\nThe images were taken by the five Lunar Orbiter images between 1966 and 1967.\nProject uses old and modern technology to produce high-res copies of the originals.</td>
    </tr>
  </tbody>
</table></div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4 id="Training">Training<a class="anchor-link" href="#Training"> </a></h4>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">seq2seq_metrics</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">&quot;rouge&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s2">&quot;compute_kwargs&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;rouge_types&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;rouge1&quot;</span><span class="p">,</span> <span class="s2">&quot;rouge2&quot;</span><span class="p">,</span> <span class="s2">&quot;rougeL&quot;</span><span class="p">,</span> <span class="s2">&quot;rougeLsum&quot;</span><span class="p">],</span> <span class="s2">&quot;use_stemmer&quot;</span><span class="p">:</span> <span class="kc">True</span><span class="p">},</span>
        <span class="s2">&quot;returns&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;rouge1&quot;</span><span class="p">,</span> <span class="s2">&quot;rouge2&quot;</span><span class="p">,</span> <span class="s2">&quot;rougeL&quot;</span><span class="p">,</span> <span class="s2">&quot;rougeLsum&quot;</span><span class="p">],</span>
    <span class="p">},</span>
    <span class="s2">&quot;bertscore&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;compute_kwargs&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;lang&quot;</span><span class="p">:</span> <span class="s2">&quot;en&quot;</span><span class="p">},</span> <span class="s2">&quot;returns&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;precision&quot;</span><span class="p">,</span> <span class="s2">&quot;recall&quot;</span><span class="p">,</span> <span class="s2">&quot;f1&quot;</span><span class="p">]},</span>
<span class="p">}</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">model</span> <span class="o">=</span> <span class="n">BaseModelWrapper</span><span class="p">(</span><span class="n">hf_model</span><span class="p">)</span>
<span class="n">learn_cbs</span> <span class="o">=</span> <span class="p">[</span><span class="n">BaseModelCallback</span><span class="p">]</span>
<span class="n">fit_cbs</span> <span class="o">=</span> <span class="p">[</span><span class="n">Seq2SeqMetricsCallback</span><span class="p">(</span><span class="n">custom_metrics</span><span class="o">=</span><span class="n">seq2seq_metrics</span><span class="p">)]</span>

<span class="n">learn</span> <span class="o">=</span> <span class="n">Learner</span><span class="p">(</span>
    <span class="n">dls</span><span class="p">,</span>
    <span class="n">model</span><span class="p">,</span>
    <span class="n">opt_func</span><span class="o">=</span><span class="n">partial</span><span class="p">(</span><span class="n">Adam</span><span class="p">),</span>
    <span class="n">loss_func</span><span class="o">=</span><span class="n">CrossEntropyLossFlat</span><span class="p">(),</span>  <span class="c1"># PreCalculatedLoss()</span>
    <span class="n">cbs</span><span class="o">=</span><span class="n">learn_cbs</span><span class="p">,</span>
    <span class="n">splitter</span><span class="o">=</span><span class="n">partial</span><span class="p">(</span><span class="n">blurr_seq2seq_splitter</span><span class="p">,</span> <span class="n">arch</span><span class="o">=</span><span class="n">hf_arch</span><span class="p">),</span>
<span class="p">)</span>

<span class="c1"># learn = learn.to_native_fp16() #.to_fp16()</span>
<span class="n">learn</span><span class="o">.</span><span class="n">freeze</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># learn.summary()</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">b</span> <span class="o">=</span> <span class="n">dls</span><span class="o">.</span><span class="n">one_batch</span><span class="p">()</span>
<span class="n">preds</span> <span class="o">=</span> <span class="n">learn</span><span class="o">.</span><span class="n">model</span><span class="p">(</span><span class="n">b</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>

<span class="nb">len</span><span class="p">(</span><span class="n">preds</span><span class="p">),</span> <span class="n">preds</span><span class="p">[</span><span class="s2">&quot;loss&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="n">preds</span><span class="p">[</span><span class="s2">&quot;logits&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>(4, torch.Size([]), torch.Size([2, 54, 50264]))</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="nb">len</span><span class="p">(</span><span class="n">b</span><span class="p">),</span> <span class="nb">len</span><span class="p">(</span><span class="n">b</span><span class="p">[</span><span class="mi">0</span><span class="p">]),</span> <span class="n">b</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="s2">&quot;input_ids&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">b</span><span class="p">[</span><span class="mi">1</span><span class="p">]),</span> <span class="n">b</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>(2, 3, torch.Size([2, 256]), 2, torch.Size([2, 54]))</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">learn</span><span class="o">.</span><span class="n">opt</span><span class="o">.</span><span class="n">param_groups</span><span class="p">))</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>3
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">learn</span><span class="o">.</span><span class="n">lr_find</span><span class="p">(</span><span class="n">suggest_funcs</span><span class="o">=</span><span class="p">[</span><span class="n">minimum</span><span class="p">,</span> <span class="n">steep</span><span class="p">,</span> <span class="n">valley</span><span class="p">,</span> <span class="n">slide</span><span class="p">])</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea "></div>

</div>

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>SuggestedLRs(minimum=8.317637839354575e-05, steep=6.309573450380412e-07, valley=9.120108734350652e-05, slide=9.120108734350652e-05)</pre>
</div>

</div>

<div class="output_area">



<div class="output_png output_subarea ">
<img src="data:image/png;base64,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"
>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">learn</span><span class="o">.</span><span class="n">fit_one_cycle</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">lr_max</span><span class="o">=</span><span class="mf">4e-5</span><span class="p">,</span> <span class="n">cbs</span><span class="o">=</span><span class="n">fit_cbs</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea "><table border="1" class="dataframe">
  <thead>
    <tr style="text-align: left;">
      <th>epoch</th>
      <th>train_loss</th>
      <th>valid_loss</th>
      <th>rouge1</th>
      <th>rouge2</th>
      <th>rougeL</th>
      <th>rougeLsum</th>
      <th>bertscore_precision</th>
      <th>bertscore_recall</th>
      <th>bertscore_f1</th>
      <th>time</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>0</td>
      <td>2.245033</td>
      <td>2.073924</td>
      <td>0.307972</td>
      <td>0.138422</td>
      <td>0.236137</td>
      <td>0.287112</td>
      <td>0.889125</td>
      <td>0.862924</td>
      <td>0.875704</td>
      <td>01:15</td>
    </tr>
  </tbody>
</table></div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4 id="Showing-results">Showing results<a class="anchor-link" href="#Showing-results"> </a></h4><p>And here we create a <code>@typedispatch</code>ed implementation of <code>Learner.show_results</code>.</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">learn</span><span class="o">.</span><span class="n">show_results</span><span class="p">(</span><span class="n">learner</span><span class="o">=</span><span class="n">learn</span><span class="p">,</span> <span class="n">input_trunc_at</span><span class="o">=</span><span class="mi">500</span><span class="p">,</span> <span class="n">target_trunc_at</span><span class="o">=</span><span class="mi">250</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea "></div>

</div>

<div class="output_area">


<div class="output_html rendered_html output_subarea "><table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>text</th>
      <th>target</th>
      <th>prediction</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Few question that there was a major chemical attack in Syria last week, and the United States has made clear that it blames the government of President Bashar al-Assad. Now, the question is how President Barack Obama will respond. For almost two years, Obama has avoided direct military involvement in Syria's civil war, only escalating aid to rebel fighters in June after suspected smaller-scale chemical weapons attacks by Syrian government forces. However, last week's attack on a Damascus suburb</td>
      <td>U.S. evidence includes satellite imagery, official says.\nObama is considering how to respond to Syrian chemical attack.\nOfficial: Obama could be presented with options within days.\nA U.S. strike "can't just be one and done," a Middle East analyst sa</td>
      <td>[ President Barack Obama has avoided direct military involvement in Syria's civil war .\nLast week's attack on a Damascus suburb obliterated the ",  NEW: Specter died of complications from non-Hodgkin's lymphoma, his family says .\nSpecter]</td>
    </tr>
  </tbody>
</table></div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4 id="Prediction">Prediction<a class="anchor-link" href="#Prediction"> </a></h4><p>We add here <a href="/blurr/modeling-seq2seq-summarization.html#Learner.blurr_summarize"><code>Learner.blurr_summarize</code></a> method to bring the results inline with the format returned via Hugging Face's pipeline method</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">test_article</span> <span class="o">=</span> <span class="s2">&quot;&quot;&quot;</span>
<span class="s2">About 10 men armed with pistols and small machine guns raided a casino in Switzerland and made off </span>
<span class="s2">into France with several hundred thousand Swiss francs in the early hours of Sunday morning, police said. </span>
<span class="s2">The men, dressed in black clothes and black ski masks, split into two groups during the raid on the Grand Casino </span>
<span class="s2">Basel, Chief Inspector Peter Gill told CNN. One group tried to break into the casino&#39;s vault on the lower level </span>
<span class="s2">but could not get in, but they did rob the cashier of the money that was not secured, he said. The second group </span>
<span class="s2">of armed robbers entered the upper level where the roulette and blackjack tables are located and robbed the </span>
<span class="s2">cashier there, he said. As the thieves were leaving the casino, a woman driving by and unaware of what was </span>
<span class="s2">occurring unknowingly blocked the armed robbers&#39; vehicles. A gunman pulled the woman from her vehicle, beat </span>
<span class="s2">her, and took off for the French border. The other gunmen followed into France, which is only about 100 </span>
<span class="s2">meters (yards) from the casino, Gill said. There were about 600 people in the casino at the time of the robbery. </span>
<span class="s2">There were no serious injuries, although one guest on the Casino floor was kicked in the head by one of the </span>
<span class="s2">robbers when he moved, the police officer said. Swiss authorities are working closely with French authorities, </span>
<span class="s2">Gill said. The robbers spoke French and drove vehicles with French lRicense plates. CNN&#39;s Andreena Narayan </span>
<span class="s2">contributed to this report.</span>
<span class="s2">&quot;&quot;&quot;</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">outputs</span> <span class="o">=</span> <span class="n">learn</span><span class="o">.</span><span class="n">blurr_generate</span><span class="p">(</span><span class="n">test_article</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="s2">&quot;summary_texts&quot;</span><span class="p">,</span> <span class="n">num_return_sequences</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
<span class="n">outputs</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>[{&#39;summary_texts&#39;: [&#34; Police: 10 men armed with pistols and small machine guns raided a Swiss casino .\nThey made off with several hundred thousand Swiss francs in the early hours of Sunday morning .\nThe men, dressed in black clothes and black ski masks, split into two groups during the raid .\nOne group tried to break into the casino&#39;s vault on the lower level but could not get&#34;,
   &#39; Police: 10 men armed with pistols and small machine guns raided a Swiss casino .\nThey made off with several hundred thousand Swiss francs in the early hours of Sunday morning .\nThe men, dressed in black clothes and black ski masks, split into two groups during the raid .\nOne group tried to break into the vault on the lower level but could not get in .&#39;,
   &#39; Police: 10 men armed with pistols and small machine guns raided a Swiss casino .\nThey made off with several hundred thousand Swiss francs in the early hours of Sunday morning .\nThe men, dressed in black clothes and black ski masks, split into two groups during the raid on the Grand Casino .&#39;]}]</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="Learner.blurr_summarize" class="doc_header"><code>Learner.blurr_summarize</code><a href="https://github.com/ohmeow/blurr/tree/master/blurr/modeling/seq2seq/summarization.py#L28" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>Learner.blurr_summarize</code>(<strong><code>inp</code></strong>, <strong>**<code>kwargs</code></strong>)</p>
</blockquote>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">learn</span><span class="o">.</span><span class="n">blurr_summarize</span><span class="p">(</span><span class="n">test_article</span><span class="p">,</span> <span class="n">num_return_sequences</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>[{&#39;summary_texts&#39;: [&#34; Police: 10 men armed with pistols and small machine guns raided a Swiss casino .\nThey made off with several hundred thousand Swiss francs in the early hours of Sunday morning .\nThe men, dressed in black clothes and black ski masks, split into two groups during the raid .\nOne group tried to break into the casino&#39;s vault on the lower level but could not get&#34;,
   &#39; Police: 10 men armed with pistols and small machine guns raided a Swiss casino .\nThey made off with several hundred thousand Swiss francs in the early hours of Sunday morning .\nThe men, dressed in black clothes and black ski masks, split into two groups during the raid .\nOne group tried to break into the vault on the lower level but could not get in .&#39;,
   &#39; Police: 10 men armed with pistols and small machine guns raided a Swiss casino .\nThey made off with several hundred thousand Swiss francs in the early hours of Sunday morning .\nThe men, dressed in black clothes and black ski masks, split into two groups during the raid on the Grand Casino .&#39;]}]</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4 id="Inference">Inference<a class="anchor-link" href="#Inference"> </a></h4><p>Using fast.ai <code>Learner.export</code> and <code>load_learner</code></p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">export_fname</span> <span class="o">=</span> <span class="s2">&quot;summarize_export&quot;</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">learn</span><span class="o">.</span><span class="n">metrics</span> <span class="o">=</span> <span class="kc">None</span>
<span class="n">learn</span><span class="o">.</span><span class="n">export</span><span class="p">(</span><span class="n">fname</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">export_fname</span><span class="si">}</span><span class="s2">.pkl&quot;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">inf_learn</span> <span class="o">=</span> <span class="n">load_learner</span><span class="p">(</span><span class="n">fname</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">export_fname</span><span class="si">}</span><span class="s2">.pkl&quot;</span><span class="p">)</span>
<span class="n">inf_learn</span><span class="o">.</span><span class="n">blurr_summarize</span><span class="p">(</span><span class="n">test_article</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>[{&#39;summary_texts&#39;: &#39; Police: 10 men armed with pistols and small machine guns raided a Swiss casino .\nThey made off with several hundred thousand Swiss&#39;}]</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="High-level-API">High-level API<a class="anchor-link" href="#High-level-API"> </a></h2>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="BlearnerForSummarization"><a href="/blurr/modeling-seq2seq-summarization.html#BlearnerForSummarization"><code>BlearnerForSummarization</code></a><a class="anchor-link" href="#BlearnerForSummarization"> </a></h3><p>We also introduce a task specific <a href="/blurr/modeling-core.html#Blearner"><code>Blearner</code></a> that get you your DataBlock, DataLoaders, and BLearner in one line of code!</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h2 id="BlearnerForSummarization" class="doc_header"><code>class</code> <code>BlearnerForSummarization</code><a href="https://github.com/ohmeow/blurr/tree/master/blurr/modeling/seq2seq/summarization.py#L35" class="source_link" style="float:right">[source]</a></h2><blockquote><p><code>BlearnerForSummarization</code>(<strong><code>dls</code></strong>:<code>DataLoaders</code>, <strong><code>hf_model</code></strong>:<code>PreTrainedModel</code>, <strong><code>base_model_cb</code></strong>:<a href="/blurr/modeling-core.html#BaseModelCallback"><code>BaseModelCallback</code></a>=<em><code>BaseModelCallback</code></em>, <strong><code>loss_func</code></strong>=<em><code>None</code></em>, <strong><code>opt_func</code></strong>=<em><code>Adam</code></em>, <strong><code>lr</code></strong>=<em><code>0.001</code></em>, <strong><code>splitter</code></strong>=<em><code>trainable_params</code></em>, <strong><code>cbs</code></strong>=<em><code>None</code></em>, <strong><code>metrics</code></strong>=<em><code>None</code></em>, <strong><code>path</code></strong>=<em><code>None</code></em>, <strong><code>model_dir</code></strong>=<em><code>'models'</code></em>, <strong><code>wd</code></strong>=<em><code>None</code></em>, <strong><code>wd_bn_bias</code></strong>=<em><code>False</code></em>, <strong><code>train_bn</code></strong>=<em><code>True</code></em>, <strong><code>moms</code></strong>=<em><code>(0.95, 0.85, 0.95)</code></em>) :: <a href="/blurr/modeling-core.html#Blearner"><code>Blearner</code></a></p>
</blockquote>
<p>Group together a <code>model</code>, some <code>dls</code> and a <code>loss_func</code> to handle training</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4 id="Example">Example<a class="anchor-link" href="#Example"> </a></h4>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">learn</span> <span class="o">=</span> <span class="n">BlearnerForSummarization</span><span class="o">.</span><span class="n">from_data</span><span class="p">(</span>
    <span class="n">cnndm_df</span><span class="p">,</span>
    <span class="s2">&quot;sshleifer/distilbart-cnn-6-6&quot;</span><span class="p">,</span>
    <span class="n">text_attr</span><span class="o">=</span><span class="s2">&quot;article&quot;</span><span class="p">,</span>
    <span class="n">summary_attr</span><span class="o">=</span><span class="s2">&quot;highlights&quot;</span><span class="p">,</span>
    <span class="n">max_length</span><span class="o">=</span><span class="mi">256</span><span class="p">,</span>
    <span class="n">max_target_length</span><span class="o">=</span><span class="mi">130</span><span class="p">,</span>
    <span class="n">dblock_splitter</span><span class="o">=</span><span class="n">RandomSplitter</span><span class="p">(),</span>
    <span class="n">dl_kwargs</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;bs&quot;</span><span class="p">:</span> <span class="mi">2</span><span class="p">},</span>
<span class="p">)</span><span class="o">.</span><span class="n">to_fp16</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">learn</span><span class="o">.</span><span class="n">fit_one_cycle</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">lr_max</span><span class="o">=</span><span class="mf">4e-5</span><span class="p">,</span> <span class="n">cbs</span><span class="o">=</span><span class="p">[</span><span class="n">BlearnerForSummarization</span><span class="o">.</span><span class="n">get_metrics_cb</span><span class="p">()])</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea "><table border="1" class="dataframe">
  <thead>
    <tr style="text-align: left;">
      <th>epoch</th>
      <th>train_loss</th>
      <th>valid_loss</th>
      <th>rouge1</th>
      <th>rouge2</th>
      <th>rougeL</th>
      <th>rougeLsum</th>
      <th>bertscore_precision</th>
      <th>bertscore_recall</th>
      <th>bertscore_f1</th>
      <th>time</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>0</td>
      <td>2.144733</td>
      <td>2.176281</td>
      <td>0.362477</td>
      <td>0.142510</td>
      <td>0.243238</td>
      <td>0.337849</td>
      <td>0.876255</td>
      <td>0.887124</td>
      <td>0.881589</td>
      <td>01:52</td>
    </tr>
  </tbody>
</table></div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">learn</span><span class="o">.</span><span class="n">show_results</span><span class="p">(</span><span class="n">learner</span><span class="o">=</span><span class="n">learn</span><span class="p">,</span> <span class="n">input_trunc_at</span><span class="o">=</span><span class="mi">500</span><span class="p">,</span> <span class="n">target_trunc_at</span><span class="o">=</span><span class="mi">250</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea "></div>

</div>

<div class="output_area">


<div class="output_html rendered_html output_subarea "><table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>text</th>
      <th>target</th>
      <th>prediction</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>(CNN) -- Gabriel Garca Mrquez, the influential, Nobel Prize-winning author of "One Hundred Years of Solitude" and "Love in the Time of Cholera," has died, his family and officials said. He was 87. The literary giant was treated in April for infections and dehydration at a Mexican hospital. Garca Mrquez, a native of Colombia, is widely credited with helping to popularize "magical realism," a genre "in which the fantastic and the realistic are combined in a richly composed world of imaginatio</td>
      <td>NEW: Colombia's President declares three days of national mourning.\nThe 87-year-old is widely credited with helping to popularize "magical realism"\nGarca Mrquez stands as one of the most honored authors on Earth.\nThe Colombian author died in Mexic</td>
      <td>[ Gabriel Garca Mrquez, 87, has died, his family and officials say .\nHe is credited with helping to popularize "magical realism," a genre "in which the fantastic and the realistic are combined in a richly composed world of imagination"\nHe was sometimes called the most significant Spanish-language author since Miguel de Cervantes .\n,  Christopher Jordan Dorner, a 270-pound former Navy lieutenant, is a suspect in the double slayings .\nHe has professed his venom against LAPD officers he claims ruined his life .\nAuthorities believe he followed through on his threats by shooting a Riverside, California, police officer and two others .]</td>
    </tr>
  </tbody>
</table></div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">test_article</span> <span class="o">=</span> <span class="s2">&quot;&quot;&quot;</span>
<span class="s2">About 10 men armed with pistols and small machine guns raided a casino in Switzerland and made off </span>
<span class="s2">into France with several hundred thousand Swiss francs in the early hours of Sunday morning, police said. </span>
<span class="s2">The men, dressed in black clothes and black ski masks, split into two groups during the raid on the Grand Casino </span>
<span class="s2">Basel, Chief Inspector Peter Gill told CNN. One group tried to break into the casino&#39;s vault on the lower level </span>
<span class="s2">but could not get in, but they did rob the cashier of the money that was not secured, he said. The second group </span>
<span class="s2">of armed robbers entered the upper level where the roulette and blackjack tables are located and robbed the </span>
<span class="s2">cashier there, he said. As the thieves were leaving the casino, a woman driving by and unaware of what was </span>
<span class="s2">occurring unknowingly blocked the armed robbers&#39; vehicles. A gunman pulled the woman from her vehicle, beat </span>
<span class="s2">her, and took off for the French border. The other gunmen followed into France, which is only about 100 </span>
<span class="s2">meters (yards) from the casino, Gill said. There were about 600 people in the casino at the time of the robbery. </span>
<span class="s2">There were no serious injuries, although one guest on the Casino floor was kicked in the head by one of the </span>
<span class="s2">robbers when he moved, the police officer said. Swiss authorities are working closely with French authorities, </span>
<span class="s2">Gill said. The robbers spoke French and drove vehicles with French lRicense plates. CNN&#39;s Andreena Narayan </span>
<span class="s2">contributed to this report.</span>
<span class="s2">&quot;&quot;&quot;</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">learn</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">test_article</span><span class="p">,</span> <span class="n">num_return_sequences</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>[{&#39;summary_texts&#39;: [&#34; The Grand Casino Basel in Switzerland was robbed Sunday morning .\nAbout 10 men armed with pistols and small machine guns raided a casino and made off .\nThe men, dressed in black clothes and black ski masks, split into two groups during the raid .\nOne group tried to break into the casino&#39;s vault on the lower level but could not get in .\n&#34;,
   &#34; The Grand Casino Basel in Switzerland was robbed Sunday morning .\nAbout 10 men armed with pistols and small machine guns raided a casino in Switzerland .\nThe men, dressed in black clothes and black ski masks, split into two groups during the raid .\nOne group tried to break into the casino&#39;s vault on the lower level but could not get in, police say .&#34;,
   &#34; The Grand Casino Basel in Switzerland was robbed Sunday morning .\nAbout 10 men armed with pistols and small machine guns raided a casino and made off .\nThe men, dressed in black clothes and black ski masks, split into two groups during the raid .\nOne group tried to break into the casino&#39;s vault on the lower level but could not get in, police say&#34;]}]</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">export_fname</span> <span class="o">=</span> <span class="s2">&quot;summarize_export&quot;</span>

<span class="n">learn</span><span class="o">.</span><span class="n">metrics</span> <span class="o">=</span> <span class="kc">None</span>
<span class="n">learn</span> <span class="o">=</span> <span class="n">learn</span><span class="o">.</span><span class="n">to_fp32</span><span class="p">()</span>
<span class="n">learn</span><span class="o">.</span><span class="n">export</span><span class="p">(</span><span class="n">fname</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">export_fname</span><span class="si">}</span><span class="s2">.pkl&quot;</span><span class="p">)</span>

<span class="n">inf_learn</span> <span class="o">=</span> <span class="n">load_learner</span><span class="p">(</span><span class="n">fname</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">export_fname</span><span class="si">}</span><span class="s2">.pkl&quot;</span><span class="p">)</span>
<span class="n">inf_learn</span><span class="o">.</span><span class="n">blurr_summarize</span><span class="p">(</span><span class="n">test_article</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>[{&#39;summary_texts&#39;: &#34; The Grand Casino Basel in Switzerland was robbed Sunday morning .\nAbout 10 men armed with pistols and small machine guns raided a casino and made off .\nThe men, dressed in black clothes and black ski masks, split into two groups during the raid .\nOne group tried to break into the casino&#39;s vault on the lower level but could not get in .\n&#34;}]</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Tests">Tests<a class="anchor-link" href="#Tests"> </a></h2><p>The purpose of the following tests is to ensure as much as possible, that the core training code works for the pretrained <strong>summarization models</strong> below.  These tests are excluded from the CI workflow because of how long they would take to run and the amount of data that would be required to download.</p>
<p><strong>Note</strong>: Feel free to modify the code below to test whatever pretrained summarization models you are working with ... and if any of your pretrained summarization models fail, please submit a github issue <em>(or a PR if you'd like to fix it yourself)</em></p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea "><table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>arch</th>
      <th>tokenizer</th>
      <th>model_name</th>
      <th>result</th>
      <th>error</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>bart</td>
      <td>BartTokenizerFast</td>
      <td>BartForConditionalGeneration</td>
      <td>PASSED</td>
      <td></td>
    </tr>
    <tr>
      <th>1</th>
      <td>led</td>
      <td>LEDTokenizerFast</td>
      <td>LEDForConditionalGeneration</td>
      <td>PASSED</td>
      <td></td>
    </tr>
    <tr>
      <th>2</th>
      <td>mbart</td>
      <td>MBartTokenizerFast</td>
      <td>MBartForConditionalGeneration</td>
      <td>PASSED</td>
      <td></td>
    </tr>
    <tr>
      <th>3</th>
      <td>mt5</td>
      <td>T5TokenizerFast</td>
      <td>MT5ForConditionalGeneration</td>
      <td>PASSED</td>
      <td></td>
    </tr>
    <tr>
      <th>4</th>
      <td>pegasus</td>
      <td>PegasusTokenizerFast</td>
      <td>PegasusForConditionalGeneration</td>
      <td>PASSED</td>
      <td></td>
    </tr>
    <tr>
      <th>5</th>
      <td>t5</td>
      <td>T5TokenizerFast</td>
      <td>T5ForConditionalGeneration</td>
      <td>PASSED</td>
      <td></td>
    </tr>
  </tbody>
</table></div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Summary">Summary<a class="anchor-link" href="#Summary"> </a></h2>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>This module includes the fundamental bits to use Blurr for summarization tasks training and inference.</p>

</div>
</div>
</div>
</div>
 

